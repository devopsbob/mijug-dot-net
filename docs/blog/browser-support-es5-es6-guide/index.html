<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <meta http-equiv="Content-Security-Policy" content="
      default-src 'self';
      script-src 'self' 'unsafe-inline' https://www.googletagmanager.com https://cdn.jsdelivr.net https://csi.gstatic.com https://pagead2.googlesyndication.com https://googleads.g.doubleclick.net https://ep1.adtrafficquality.google https://ep2.adtrafficquality.google https://csi.gstatic.com ;
      style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net ;
      style-src-elem 'self' 'unsafe-inline' ;
      img-src 'self' data: https: https://www.google-analytics.com https://pagead2.googlesyndication.com https://ep1.adtrafficquality.google https://ep2.adtrafficquality.google;
      font-src 'self' https://cdn.jsdelivr.net https://fonts.gstatic.com data:;
      connect-src 'self' https://www.google-analytics.com https://pagead2.googlesyndication.com https://googleads.g.doubleclick.net https://ep1.adtrafficquality.google https://ep2.adtrafficquality.google ;
      frame-src 'self' https://www.google.com https://googleads.g.doubleclick.net https://pagead2.googlesyndication.com https://ep1.adtrafficquality.google https://ep2.adtrafficquality.google ;
      object-src 'none';
      base-uri 'self';
      form-action 'self';
      manifest-src 'self';block-all-mixed-content;upgrade-insecure-requests">

    <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin="anonymous" />
    
    <link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous" />
    <link rel="preconnect" href="https://www.google-analytics.com" crossorigin="anonymous" />
    
    
    <link rel="preconnect" href="https://pagead2.googlesyndication.com" crossorigin="anonymous" />
    <link rel="preconnect" href="https://googleads.g.doubleclick.net" crossorigin="anonymous" />
    <meta name="google-adsense-account" content="ca-pub-3383458876439157" />
    

    <!-- Critical navigation styles - always inlined for immediate user interaction -->
<style>
  /* Navigation toggle button - ALWAYS VISIBLE */
  .nav-toggle {
    display: flex;
    align-items: center;
    justify-content: center;
    position: absolute;
    right: 1rem;
    top: 50%;
    transform: translateY(-50%);
    background: #2c5aa0;
    color: white;
    border: none;
    padding: 0.5rem 1rem;
    font-size: 0.9rem;
    font-weight: 600;
    cursor: pointer;
    border-radius: 6px;
    z-index: 101;
    min-height: 24px;
    min-width: 24px;
  }

  /* Progressive enhancement - hide desktop nav when JS enabled */
  html.js nav.primary-nav {
    display: none;
  }

  /* Overlay navigation */
  html.js nav.primary-nav.nav-overlay {
    display: block;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    width: 100vw;
    height: 100vh;
    background: rgba(0, 0, 0, 0.85);
    z-index: 100;
    opacity: 0;
    visibility: hidden;
    transform: translateY(-20px);
    transition: opacity 0.3s ease, transform 0.3s ease, visibility 0.3s ease;
    overflow-y: auto;
  }

  html.js nav.primary-nav.nav-overlay.nav-visible {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
  }

  /* Body scroll lock when overlay is open */
  body.nav-open {
    overflow: hidden;
    position: fixed;
    width: 100%;
  }

  /* No-JS fallback */
  html.no-js .nav-toggle {
    display: none;
  }

  /* Accessibility - visually hidden elements */
  .visually-hidden {
    position: absolute !important;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
  }

  /* Performance optimization for font loading */
  html {
    font-display: swap;
  }

  /* Reduce layout shift during navigation initialization */
  .site-header .wrapper {
    min-height: 55.95px;
  }
</style>

    <!-- Preload fonts for better performance -->
  <link
    rel="preload"
    href="/assets/fonts/InterVariable.woff2"
    as="font"
    type="font/woff2"
    crossorigin="anonymous"
    immutable
  />
  <link
    rel="preconnect"
    href="https://fonts.googleapis.com"
  />
  <link
    rel="preconnect"
    href="https://fonts.gstatic.com"
    crossorigin
  />

    <!-- Critical CSS for above-the-fold content -->
<style>
/**
 * Critical path CSS for above-the-fold content
 * Optimized for < 12s build target and initial viewport rendering
 */

/* Base variables for theming */
:root {
  --bg-color: #ffffff;
  --text-color: #222222;
  --accent-color: #1e8449; /* WCAG AA compliant green */
  --link-color: #0066cc;
  --nav-bg: #f8f8f8;
  --border-color: #e8e8e8;
  --header-color: #424242;
  --focus-outline: 2px solid #1e8449;
  --font-family-base: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
  --font-size-base: 16px;
  --line-height-base: 1.5;
}

/* Base element styles */
html {
  font-size: var(--font-size-base);
  font-family: var(--font-family-base);
  line-height: var(--line-height-base);
  -webkit-text-size-adjust: 100%;
  text-size-adjust: 100%;
}

body {
  margin: 0;
  padding: 0;
  color: var(--text-color);
  background-color: var(--bg-color);
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}

/* Wrapper for content layout */
.wrapper {
  max-width: 960px;
  margin: 0 auto;
  padding: 0 15px;
  width: calc(100% - 30px);
}

/* Critical header and navigation styles */
.site-header {
  border-bottom: 1px solid var(--border-color);
  min-height: 56px;
  background-color: var(--nav-bg);
  position: relative;
  display: flex;
  align-items: center;
}

.site-header .wrapper {
  display: flex;
  justify-content: space-between;
  align-items: center;
  width: 100%;
}

.site-title {
  font-size: 1.5rem;
  font-weight: 300;
  letter-spacing: -1px;
  margin-bottom: 0;
  color: var(--header-color);
  text-decoration: none;
  display: flex;
  align-items: center;
  line-height: 56px;
}

.site-title img {
  margin-right: 10px;
  width: 50px;
  height: 50px;
}

.site-title.long-title {
  font-size: 1.25rem;
}

/* Navigation styling */
.site-nav {
  position: relative;
  line-height: 56px;
}

.site-nav .nav-trigger {
  display: none;
}

.site-nav .menu-icon {
  display: none;
}

.site-nav .page-link {
  color: var(--text-color);
  line-height: 1.5;
  text-decoration: none;
  margin-right: 20px;
}

.site-nav .page-link:hover {
  color: var(--accent-color);
}

.nav-button {
  background-color: var(--accent-color);
  color: white;
  border: none;
  padding: 8px 12px;
  border-radius: 4px;
  cursor: pointer;
  font-family: var(--font-family-base);
  font-size: 0.875rem;
  font-weight: 500;
  line-height: 1.2;
}

/* Main content area */
.page-content {
  padding: 30px 0;
  flex: 1;
}

/* Skip link - accessibility feature */
.skip-to-content {
  position: absolute;
  top: -50px;
  left: 10px;
  background: var(--accent-color);
  color: white;
  padding: 8px;
  z-index: 100;
  transition: top 0.3s ease;
}

.skip-to-content:focus {
  top: 10px;
}

/* Focus outline for accessibility */
:focus {
  outline: var(--focus-outline);
  outline-offset: 2px;
}

/* Basic media query for responsive design */
@media screen and (max-width: 600px) {
  .site-nav {
    position: absolute;
    top: 9px;
    right: 15px;
    background-color: var(--nav-bg);
    border: 1px solid var(--border-color);
    border-radius: 5px;
    text-align: right;
    z-index: 10;
  }

  .site-nav .menu-icon {
    display: block;
    float: right;
    width: 36px;
    height: 26px;
    line-height: 0;
    padding-top: 10px;
    text-align: center;
    cursor: pointer;
  }

  .site-nav .menu-icon > svg {
    width: 18px;
    height: 15px;
  }

  .site-nav .trigger {
    clear: both;
    display: none;
    padding-bottom: 5px;
  }

  .site-nav:not([popover]) .nav-trigger:checked ~ .trigger {
    display: block;
  }

  .site-nav .page-link {
    display: block;
    padding: 5px 10px;
    margin: 0;
  }
}

/* SR-only class for accessibility */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

/* Basic typography for content */
h1, h2, h3, h4, h5, h6 {
  margin-top: 0;
  color: var(--header-color);
}

h1 {
  font-size: 2rem;
  margin-bottom: 0.5em;
}

p {
  margin-top: 0;
  margin-bottom: 1em;
}

/* SVG icon in header */
.svg-icon {
  width: 16px;
  height: 16px;
  display: inline-block;
  fill: currentColor;
  vertical-align: text-bottom;
  flex-shrink: 0;
  box-sizing: content-box;
}

/* Image aspect ratio and container styles */
img {
  aspect-ratio: attr(width) / attr(height);
}

.image-container {
  position: relative;
  height: 0;
  overflow: hidden;
}

.image-container--16-9 {
  padding-bottom: 56.25%; /* 16:9 aspect ratio */
}

.image-container--4-3 {
  padding-bottom: 75%; /* 4:3 aspect ratio */
}

.image-container img {
  position: absolute;
  width: 100%;
  height: 100%;
  object-fit: cover;
}

/* Cookie consent banner styles */
#cookie-consent-banner {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  z-index: 1000;
  max-height: 0;
  opacity: 0;
  transform: translateY(100%);
  transition: transform 0.3s, opacity 0.3s, max-height 0s 0.3s;
  overflow: hidden;
}

#cookie-consent-banner.visible {
  max-height: 200px;
  opacity: 1;
  transform: translateY(0);
  transition: transform 0.3s, opacity 0.3s;
}

/* Advertisement container styles */
.ad-container {
  min-height: 250px;
  display: flex;
  align-items: center;
  justify-content: center;
  background-color: #f9f9f9;
  margin: 1rem 0;
  overflow: hidden;
  contain: layout size;
}

.ad-container::before {
  content: "Advertisement";
  color: #777;
  font-size: 0.75rem;
  position: absolute;
  top: 5px;
  right: 5px;
}

/* Mermaid diagram container styles */
.mermaid-container {
  position: relative;
  width: 100%;
  min-height: 150px;
  margin: 1.5rem 0;
  background-color: rgba(0,0,0,0.03);
  border-radius: 4px;
  overflow: hidden;
  contain: layout style paint;
}

.mermaid-container::before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background:
    linear-gradient(90deg, transparent 25%, rgba(255,255,255,.5) 50%, transparent 75%) -200% 0 / 400% 100%,
    linear-gradient(rgba(0,0,0,.1) 0%, transparent 20%, transparent 80%, rgba(0,0,0,.1) 100%);
  animation: loading 1.5s infinite linear;
  opacity: 0.5;
}

@keyframes loading {
  to { background-position: 100% 0, 0 0; }
}

[popover] {
  contain: layout size;
}

.site-nav[popover] {
  /* Pre-compute layout position */
  position: absolute;
  top: 9px;
  right: 15px;
  z-index: 100;
  /* Prevent layout shift during animations */
  transform: translateZ(0);
  will-change: transform;
}
</style>
<link rel="preload" href="/assets/main.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="/assets/main.css"></noscript>


    <title>
      The Great JavaScript Divide | My Info Just Under Glass
    </title>
    <meta
      name="description"
      content="When a friend&#39;s old browser broke my navigation menu, it sparked a deep dive into JavaScript standards that changed how I think about web development forever."
    />
    
    <meta name="version" content="Oct 03, 2025" />
    

    

    <meta name="google-site-verification" content="googlece83719b3f856e56" />
    <meta name="cache-version" content="20251007172153" />

    <link rel="preload" as="style" href="/assets/main.css?v=20251009150200" media="print" crossorigin><link rel="stylesheet" href="/assets/main.css?v=20251009150200" media="print">

    <noscript>
      <link rel="stylesheet" href="/assets/main.css?v=20251009150200">
    </noscript>

    <link
      rel="alternate"
      type="application/rss+xml"
      title="My Info Just Under Glass"
      href="/feed.xml"
    />
    
    
    <link
      rel="icon"
      type="image/svg+xml"
      href="/assets/logo-mijug-96x96.png?v=20251007172153"
    />
    
    <link
      rel="shortcut icon"
      type="image/x-icon"
      href="/favicon.ico"
    />
    <link rel="manifest" href="/manifest.webmanifest" />

    <meta name="description" content="A developer's journey from navigation nightmare to ES6 enlightenment - and the surprising security risks lurking in legacy browser support decisions." />
<meta property="og:title" content="The Great JavaScript Divide" />
<meta property="og:description" content="A developer's journey from navigation nightmare to ES6 enlightenment - and the surprising security risks lurking in legacy browser support decisions." />
<meta property="og:url" content="https://www.mijug.net/blog/browser-support-es5-es6-guide/" />
<meta property="og:site_name" content="My Info Just Under Glass" />
<meta property="og:type" content="article" /><meta property="og:image" content="https://www.mijug.net/" /><meta property="article:author" content="https://www.linkedin.com/in/bobkranson" /><link rel="canonical" href="https://www.mijug.net/blog/browser-support-es5-es6-guide/" />


    

    

    <script>
  window.MIJUG = window.MIJUG || {};
  window.MIJUG.cacheVersion = "20251007172153";
</script>

  
  <script>
    window.MIJUG_DISABLE_PRINT = true;
  </script>
  
  </head>
  
    <body oncontextmenu="return false;">
  
    <header class="site-header" role="banner">
      <noscript>
        <div class="legacy-browser-notice" role="alert">
          <strong>No Commerce Available</strong>
          <span class="notice-detail">JavaScript is required for commerce functionality.</span>
        </div>
      </noscript>

      <div class="wrapper">
        <a class="site-title" rel="home" href="/">
          
          <img src="/assets/logo-mijug-96x96.png?v=20251007172153" alt="My Info Just Under Glass" width="50" height="50">
           My Info Just Under Glass
        </a>

        <!-- Mobile navigation toggle button -->
        <button class="nav-toggle" type="button" aria-controls="primary-navigation" aria-expanded="false" aria-label="Toggle navigation menu">
          Menu
        </button>

        <!-- Fallback navigation for no-JS and legacy browsers -->
        <noscript>
          <nav class="primary-nav fallback-nav" role="navigation" aria-label="Main navigation">
            <ul role="list">
              <li role="listitem">
                <a href="/about/" aria-label="Navigate to About">About</a>
              </li>
              <li role="listitem">
                <a href="/blog/" aria-label="Navigate to Blog">Blog</a>
              </li>
              <li role="listitem">
                <a href="/contact/" aria-label="Navigate to Contact">Contact</a>
              </li>
            </ul>
          </nav>
        </noscript>

        <!-- Full navigation for modern browsers (enhanced by JavaScript) -->
        <nav id="primary-navigation" class="primary-nav js-enhanced-nav" role="dialog" aria-modal="true" aria-hidden="true">

          <!-- Basic navigation shown to legacy browsers -->
          <div class="legacy-nav-fallback">
            <ul role="list">
              <li role="listitem">
                <a href="/about/" aria-label="Navigate to About">About</a>
              </li>
              <li role="listitem">
                <a href="/blog/" aria-label="Navigate to Blog">Blog</a>
              </li>
              <li role="listitem">
                <a href="/contact/" aria-label="Navigate to Contact">Contact</a>
              </li>
            </ul>
          </div>

          <!-- Full navigation for modern browsers -->
          <div class="modern-nav-content">
            <ul role="list">
              
                <li role="listitem">
                  <a href="/blog/" aria-label="Navigate to Blog">
                     Blog
                  </a>
                </li>
              
                <li role="listitem">
                  <a href="/about/" aria-label="Navigate to About">
                     About
                  </a>
                </li>
              
                <li role="listitem">
                  <a href="/docs/getting-started/" aria-label="Navigate to Getting Started">
                     Getting Started
                  </a>
                </li>
              
                <li role="listitem">
                  <a href="/docs/welcome-mijug-workspace/" aria-label="Navigate to Workspace Overview">
                     Workspace Overview
                  </a>
                </li>
              
                <li role="listitem">
                  <a href="/docs/frontmatter-cms/" aria-label="Navigate to FrontMatter CMS Usage">
                     FrontMatter CMS Usage
                  </a>
                </li>
              
                <li role="listitem">
                  <a href="/docs/accessibility-testing/" aria-label="Navigate to Accessibility Testing Configuration">
                     Accessibility Testing Configuration
                  </a>
                </li>
              
                <li role="listitem">
                  <a href="/docs/browser-management/" aria-label="Navigate to Browser Management for Testing">
                     Browser Management for Testing
                  </a>
                </li>
              
                <li role="listitem">
                  <a href="/docs/browser-compatibility-testing/" aria-label="Navigate to Browser Compatibility Testing">
                     Browser Compatibility Testing
                  </a>
                </li>
              
                <li role="listitem">
                  <a href="/docs/liquid-tags-examples/" aria-label="Navigate to Liquid Tags Examples">
                     Liquid Tags Examples
                  </a>
                </li>
              
                <li role="listitem">
                  <a href="/docs/tags-and-categories-guide/" aria-label="Navigate to Tags and Categories System Guide">
                     Tags and Categories System Guide
                  </a>
                </li>
              
                <li role="listitem">
                  <a href="/docs/performance-optimization/" aria-label="Navigate to Performance Optimization Guide">
                     Performance Optimization Guide
                  </a>
                </li>
              
                <li role="listitem">
                  <a href="/docs/testing-performance-evolution/" aria-label="Navigate to Testing Performance and Development Evolution">
                     Testing Performance and Development Evolution
                  </a>
                </li>
              
                <li role="listitem">
                  <a href="/docs/cache-management/" aria-label="Navigate to Cache Management Strategies">
                     Cache Management Strategies
                  </a>
                </li>
              
                <li role="listitem">
                  <a href="/docs/mermaid-configuration-guide/" aria-label="Navigate to Mermaid Diagram Configuration Guide">
                     Mermaid Diagram Configuration Guide
                  </a>
                </li>
              
                <li role="listitem">
                  <a href="/docs/mermaid-quick-start/" aria-label="Navigate to Mermaid Quick Start">
                     Mermaid Quick Start
                  </a>
                </li>
              
                <li role="listitem">
                  <a href="/docs/mermaid-examples/" aria-label="Navigate to Mermaid Diagram Examples">
                     Mermaid Diagram Examples
                  </a>
                </li>
              
                <li role="listitem">
                  <a href="/docs/mermaid-diagrams-sample/" aria-label="Navigate to Mermaid Diagrams Sample">
                     Mermaid Diagrams Sample
                  </a>
                </li>
              
                <li role="listitem">
                  <a href="/docs/mermaid-test-runner/" aria-label="Navigate to Mermaid Diagrams Test Runner">
                     Mermaid Diagrams Test Runner
                  </a>
                </li>
              
                <li role="listitem">
                  <a href="/docs/rel-attribute-guide/" aria-label="Navigate to The rel Attribute in HTML Links: A Comprehensive Guide">
                     The rel Attribute in HTML Links: A Comprehensive Guide
                  </a>
                </li>
              
                <li role="listitem">
                  <a href="/docs/exploring-limitations-of-gitea-and-ruby/" aria-label="Navigate to Exploring the Limitations of Gitea and Ruby">
                     Exploring the Limitations of Gitea and Ruby
                  </a>
                </li>
              
            </ul>
          </div>
        </nav>

        <div id="menu-status" class="visually-hidden" role="status" aria-live="polite"></div>
      </div>
    </header>

    <main class="page-content" aria-label="Content">
      <div class="wrapper">
<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">The Great JavaScript Divide</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2025-10-03T12:44:05-04:00" itemprop="datePublished">
        Published Oct 3, 2025
      </time><span class="post-meta-separator"> • </span>
      <time class="dt-modified" datetime="2025-10-03T20:05:28-04:00" itemprop="dateModified">
        Updated Oct 3, 2025
      </time><span class="post-meta-separator"> • </span>
      <span itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-author h-card" itemprop="name">MIJUG Team</span>
      </span></p>
<p class="post-description">A developer's journey from navigation nightmare to ES6 enlightenment - and the surprising security risks lurking in legacy browser support decisions.</p>
<div class="post-tags">
<span class="tag">#typescript</span><span class="tag">#development</span><span class="tag">#testing</span><span class="tag">#documentation</span><span class="tag">#guide</span>
</div></header>

  <div class="post-content e-content" itemprop="articleBody">
<p>Picture this: Your friend visits your carefully crafted website, excited to see your latest project. They tap the navigation menu on their phone… and nothing happens. The hamburger icon just sits there, mocking both of you. Sound familiar?</p>

<p>This exact scenario happened to me last month, and it sent me spiraling down a rabbit hole that fundamentally changed how I approach JavaScript development in 2025. My friend’s browser version 109 - a digital fossil from the Windows 8 era - couldn’t handle my modern JavaScript. But here’s the kicker: <strong>they weren’t alone</strong>.</p>

<h2 id="️-the-tale-of-two-javascripts-a-16-year-evolution">🕰️ The Tale of Two JavaScripts: A 16-Year Evolution</h2>

<p>Let’s rewind to understand how we got here. Imagine JavaScript as a city that underwent massive urban renewal:</p>

<h3 id="es5-2009-the-reliable-old-town"><strong>ES5 (2009): The Reliable Old Town</strong></h3>

<p>For six years, ES5 was <em>the</em> JavaScript. Reliable, predictable, and supported everywhere:</p>

<div class="language-javascript highlighter-rouge">
<span class="c1">// The old way - verbose but universal</span>
<span class="kd">var</span> <span class="nx">items</span> <span class="o">=</span> <span class="p">[</span><span class="dl">"</span><span class="s2">home</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">about</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">contact</span><span class="dl">"</span><span class="p">];</span>
<span class="kd">var</span> <span class="nx">navigationHtml</span> <span class="o">=</span> <span class="dl">""</span><span class="p">;</span>
<span class="k">for </span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">items</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">navigationHtml</span> <span class="o">+=</span> <span class="dl">'</span><span class="s1">&lt;li&gt;&lt;a href="/</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">items</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">"&gt;</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">items</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">&lt;/a&gt;&lt;/li&gt;</span><span class="dl">"</span><span class="p">;</span>
<span class="p">}</span>
</div>

<h3 id="es6-2015-the-modern-metropolis"><strong>ES6 (2015): The Modern Metropolis</strong></h3>

<p>Then ES6 arrived like a tech boom, bringing features that made developers weep with joy:</p>

<div class="language-javascript highlighter-rouge">
<span class="c1">// The new way - elegant and powerful</span>
<span class="kd">const</span> <span class="nx">items</span> <span class="o">=</span> <span class="p">[</span><span class="dl">"</span><span class="s2">home</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">about</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">contact</span><span class="dl">"</span><span class="p">];</span>
<span class="kd">const</span> <span class="nx">navigationHtml</span> <span class="o">=</span> <span class="nx">items</span><span class="p">.</span><span class="nf">map</span><span class="p">((</span><span class="nx">item</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="s2">`&lt;li&gt;&lt;a href="/</span><span class="p">${</span><span class="nx">item</span><span class="p">}</span><span class="s2">"&gt;</span><span class="p">${</span><span class="nx">item</span><span class="p">}</span><span class="s2">&lt;/a&gt;&lt;/li&gt;`</span><span class="p">).</span><span class="nf">join</span><span class="p">(</span><span class="dl">""</span><span class="p">);</span>
</div>

<p>Arrow functions! Template literals! Array methods that actually make sense! It was revolutionary.</p>

<h2 id="-my-navigation-menu-nightmare-and-how-it-taught-me-everything">🚨 My Navigation Menu Nightmare (And How It Taught Me Everything)</h2>

<p>When my friend’s browser failed, I went into full detective mode. Here’s what I initially tried:</p>

<h3 id="attempt-1-the-smart-detection-strategy"><strong>Attempt #1: The “Smart” Detection Strategy</strong></h3>

<div class="language-javascript highlighter-rouge">
<span class="c1">// Seemed brilliant at first...</span>
<span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nf">remove</span><span class="p">(</span><span class="dl">"</span><span class="s2">no-js</span><span class="dl">"</span><span class="p">);</span>
<span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="dl">"</span><span class="s2">js</span><span class="dl">"</span><span class="p">);</span>

<span class="c1">// Different styles for different capabilities</span>
<span class="k">if </span><span class="p">(</span><span class="dl">"</span><span class="s2">noModule</span><span class="dl">"</span> <span class="k">in</span> <span class="nx">HTMLScriptElement</span><span class="p">.</span><span class="nx">prototype</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// ES6 supported - load the fancy stuff</span>
  <span class="nf">loadModernNavigation</span><span class="p">();</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="c1">// ES5 only - basic functionality</span>
  <span class="nf">loadLegacyNavigation</span><span class="p">();</span>
<span class="p">}</span>
</div>

<h3 id="the-reality-check"><strong>The Reality Check</strong></h3>

<p>This approach spiraled out of control faster than a JavaScript framework’s bundle size:</p>

<ul>
  <li>❌ <strong>CSS bloat</strong>: Duplicate styles for every component</li>
  <li>❌ <strong>JavaScript chaos</strong>: Maintaining two codebases</li>
  <li>❌ <strong>Navigation nightmare</strong>: Different behaviors breaking screen readers</li>
  <li>❌ <strong>Developer sanity</strong>: Gone. Completely gone.</li>
</ul>

<h2 id="-the-eureka-moment-typescript--build-pipeline--developer-happiness">💡 The Eureka Moment: TypeScript + Build Pipeline = Developer Happiness</h2>

<p>After three days of pulling my hair out, I discovered a game-changing approach that actually works:</p>

<h3 id="step-1-write-once-target-many"><strong>Step 1: Write Once, Target Many</strong></h3>

<div class="language-typescript highlighter-rouge">
<span class="c1">// Single source of truth in TypeScript</span>
<span class="kr">interface</span> <span class="nx">NavigationItem</span> <span class="p">{</span>
  <span class="nl">label</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
  <span class="nl">url</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
  <span class="nl">ariaLabel</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">const</span> <span class="nx">createNavigation</span> <span class="o">=</span> <span class="p">(</span><span class="nx">items</span><span class="p">:</span> <span class="nx">NavigationItem</span><span class="p">[]):</span> <span class="kr">string</span> <span class="o">=&gt;</span>
  <span class="nx">items</span><span class="p">.</span><span class="nf">map</span><span class="p">(({</span> <span class="nx">label</span><span class="p">,</span> <span class="nx">url</span><span class="p">,</span> <span class="nx">ariaLabel</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="s2">`&lt;li&gt;&lt;a href="</span><span class="p">${</span><span class="nx">url</span><span class="p">}</span><span class="s2">" aria-label="</span><span class="p">${</span><span class="nx">ariaLabel</span><span class="p">}</span><span class="s2">"&gt;</span><span class="p">${</span><span class="nx">label</span><span class="p">}</span><span class="s2">&lt;/a&gt;&lt;/li&gt;`</span><span class="p">).</span><span class="nf">join</span><span class="p">(</span><span class="dl">""</span><span class="p">);</span>
</div>

<h3 id="step-2-smart-compilation-strategy"><strong>Step 2: Smart Compilation Strategy</strong></h3>

<div class="language-bash highlighter-rouge">
<span class="c"># Modern build (ES6+) - smaller, faster</span>
npm run build:modern
<span class="c"># → Outputs clean ES6 for 90% of users</span>

<span class="c"># Legacy build (ES5) - compatible, larger</span>
npm run build:legacy
<span class="c"># → Babel-transpiled for the remaining 10%</span>
</div>

<h3 id="step-3-differential-loading-magic"><strong>Step 3: Differential Loading Magic</strong></h3>

<div class="language-html highlighter-rouge">
<span class="c">&lt;!-- The browser chooses automatically! --&gt;</span>
<span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"module"</span> <span class="na">src=</span><span class="s">"/js/navigation.modern.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">nomodule</span> <span class="na">src=</span><span class="s">"/js/navigation.legacy.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
</div>

<p><strong>The result?</strong> Modern browsers get fast, optimized code. Legacy browsers get compatible code. Developers maintain one codebase. Everyone wins!</p>

<h2 id="-the-security-elephant-in-the-room">🔐 The Security Elephant in the Room</h2>

<p>Here’s where things get serious. While researching browser version 109, I discovered something alarming:</p>

<blockquote>
  <p><strong>Browsers more than 2 years old often have unpatched security vulnerabilities</strong></p>
</blockquote>

<p>My friend’s decade-old browser wasn’t just missing JavaScript features - it was a security liability. This revelation completely shifted my perspective on legacy support.</p>

<h3 id="the-uncomfortable-truth"><strong>The Uncomfortable Truth</strong></h3>

<p>Supporting ancient browsers might actually harm users by:</p>

<ul>
  <li>Enabling continued use of vulnerable software</li>
  <li>Providing false confidence in insecure browsing</li>
  <li>Potentially exposing sensitive data to known exploits</li>
</ul>

<h3 id="the-ethical-solution"><strong>The Ethical Solution</strong></h3>

<p>Instead of silently supporting dangerous browsers, I implemented compassionate messaging:</p>

<div class="language-html highlighter-rouge">
<span class="nt">&lt;noscript&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"browser-update-notice"</span> <span class="na">role=</span><span class="s">"alert"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;h2&gt;</span>🛡️ Security <span class="ni">&amp;amp;</span> Experience Notice<span class="nt">&lt;/h2&gt;</span>
    <span class="nt">&lt;p&gt;</span>
      Your browser may have security vulnerabilities. For your protection and the best experience, please consider
      updating.
    <span class="nt">&lt;/p&gt;</span>
    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"https://browsehappy.com/"</span> <span class="na">class=</span><span class="s">"update-button"</span><span class="nt">&gt;</span>Find a Secure Browser<span class="nt">&lt;/a&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/noscript&gt;</span>
</div>

<h2 id="-the-2025-decision-framework-when-to-support-what">🎯 The 2025 Decision Framework: When to Support What</h2>

<p>Not all projects are created equal. Here’s my decision matrix:</p>

<h3 id="-definitely-support-es5-when"><strong>✅ Definitely Support ES5 When:</strong></h3>

<ul>
  <li>
<strong>Government/Public Services</strong>: Navigation is paramount</li>
  <li>
<strong>Enterprise Apps</strong>: Controlled environments with old systems</li>
  <li>
<strong>Global Audiences</strong>: Developing regions with older devices</li>
  <li>
<strong>Educational Content</strong>: Maximum reach requirements</li>
</ul>

<p><strong>Real Example</strong>: A government healthcare portal serves citizens with 15-year-old computers in rural libraries.</p>

<h3 id="-consider-dropping-es5-when"><strong>❌ Consider Dropping ES5 When:</strong></h3>

<ul>
  <li>
<strong>Developer Tools</strong>: Technical audience with modern setups</li>
  <li>
<strong>SaaS Applications</strong>: Business users with regular updates</li>
  <li>
<strong>E-commerce</strong>: Security and performance are critical</li>
  <li>
<strong>Creative Portfolios</strong>: Showcasing modern capabilities</li>
</ul>

<p><strong>Real Example</strong>: A cryptocurrency trading platform where security vulnerabilities could cost users millions.</p>

<h3 id="-the-gray-area-projects"><strong>🤔 The Gray Area Projects:</strong></h3>

<p>Most projects fall somewhere in between. The solution? <strong>Progressive enhancement with graceful degradation.</strong></p>

<h2 id="️-practical-implementation-strategies-that-actually-work">🛠️ Practical Implementation Strategies That Actually Work</h2>

<h3 id="strategy-1-the-detection-first-approach"><strong>Strategy 1: The Detection-First Approach</strong></h3>

<div class="language-javascript highlighter-rouge">
<span class="c1">// Feature detection over browser sniffing</span>
<span class="kd">const</span> <span class="nx">capabilities</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">modules</span><span class="p">:</span> <span class="dl">"</span><span class="s2">noModule</span><span class="dl">"</span> <span class="k">in</span> <span class="nx">HTMLScriptElement</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span>
  <span class="na">webp</span><span class="p">:</span> <span class="p">(</span><span class="nx">canvas</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">canvas</span><span class="p">.</span><span class="nf">toDataURL</span><span class="p">(</span><span class="dl">"</span><span class="s2">image/webp</span><span class="dl">"</span><span class="p">).</span><span class="nf">indexOf</span><span class="p">(</span><span class="dl">"</span><span class="s2">webp</span><span class="dl">"</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
  <span class="na">intersectionObserver</span><span class="p">:</span> <span class="dl">"</span><span class="s2">IntersectionObserver</span><span class="dl">"</span> <span class="k">in</span> <span class="nb">window</span><span class="p">,</span>
<span class="p">};</span>

<span class="c1">// Load features based on actual capabilities</span>
<span class="k">if </span><span class="p">(</span><span class="nx">capabilities</span><span class="p">.</span><span class="nx">modules</span> <span class="o">&amp;&amp;</span> <span class="nx">capabilities</span><span class="p">.</span><span class="nx">intersectionObserver</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">import</span><span class="p">(</span><span class="dl">"</span><span class="s2">./advanced-features.js</span><span class="dl">"</span><span class="p">);</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="k">import</span><span class="p">(</span><span class="dl">"</span><span class="s2">./basic-features.js</span><span class="dl">"</span><span class="p">);</span>
<span class="p">}</span>
</div>

<h3 id="strategy-2-the-build-pipeline-powerhouse"><strong>Strategy 2: The Build Pipeline Powerhouse</strong></h3>

<div class="language-javascript highlighter-rouge">
<span class="c1">// rollup.config.js - Automatic code splitting for modern and legacy builds</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">babel</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@rollup/plugin-babel</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">nodeResolve</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@rollup/plugin-node-resolve</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">terser</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@rollup/plugin-terser</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">createConfig</span> <span class="o">=</span> <span class="p">(</span><span class="nx">isLegacy</span> <span class="o">=</span> <span class="kc">false</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">({</span>
  <span class="na">input</span><span class="p">:</span> <span class="dl">"</span><span class="s2">src/main.js</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">output</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">file</span><span class="p">:</span> <span class="s2">`dist/bundle.</span><span class="p">${</span><span class="nx">isLegacy</span> <span class="p">?</span> <span class="dl">"</span><span class="s2">legacy</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">modern</span><span class="dl">"</span><span class="p">}</span><span class="s2">.js`</span><span class="p">,</span>
    <span class="na">format</span><span class="p">:</span> <span class="nx">isLegacy</span> <span class="p">?</span> <span class="dl">"</span><span class="s2">iife</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">es</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">name</span><span class="p">:</span> <span class="nx">isLegacy</span> <span class="p">?</span> <span class="dl">"</span><span class="s2">App</span><span class="dl">"</span> <span class="p">:</span> <span class="kc">undefined</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="na">plugins</span><span class="p">:</span> <span class="p">[</span>
    <span class="nf">nodeResolve</span><span class="p">(),</span>
    <span class="nf">babel</span><span class="p">({</span>
      <span class="na">babelHelpers</span><span class="p">:</span> <span class="dl">"</span><span class="s2">bundled</span><span class="dl">"</span><span class="p">,</span>
      <span class="na">exclude</span><span class="p">:</span> <span class="dl">"</span><span class="s2">node_modules/**</span><span class="dl">"</span><span class="p">,</span>
      <span class="na">presets</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span>
          <span class="dl">"</span><span class="s2">@babel/preset-env</span><span class="dl">"</span><span class="p">,</span>
          <span class="p">{</span>
            <span class="na">targets</span><span class="p">:</span> <span class="nx">isLegacy</span> <span class="p">?</span> <span class="p">{</span> <span class="na">browsers</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">&gt; 0.25%</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">not dead</span><span class="dl">"</span><span class="p">]</span> <span class="p">}</span> <span class="p">:</span> <span class="p">{</span> <span class="na">esmodules</span><span class="p">:</span> <span class="kc">true</span> <span class="p">},</span>
          <span class="p">},</span>
        <span class="p">],</span>
      <span class="p">],</span>
    <span class="p">}),</span>
    <span class="nf">terser</span><span class="p">(),</span>
  <span class="p">],</span>
<span class="p">});</span>

<span class="c1">// Export both modern and legacy configurations</span>
<span class="k">export</span> <span class="k">default</span> <span class="p">[</span>
  <span class="nf">createConfig</span><span class="p">(</span><span class="kc">false</span><span class="p">),</span> <span class="c1">// Modern build</span>
  <span class="nf">createConfig</span><span class="p">(</span><span class="kc">true</span><span class="p">),</span> <span class="c1">// Legacy build</span>
<span class="p">];</span>
</div>

<h3 id="strategy-3-the-performance-monitoring-approach"><strong>Strategy 3: The Performance Monitoring Approach</strong></h3>

<p>Track the impact of your decisions with real data:</p>

<div class="language-javascript highlighter-rouge">
<span class="c1">// Monitor browser capabilities in production</span>
<span class="kd">const</span> <span class="nx">browserMetrics</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">supportsModules</span><span class="p">:</span> <span class="dl">"</span><span class="s2">noModule</span><span class="dl">"</span> <span class="k">in</span> <span class="nx">HTMLScriptElement</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span>
  <span class="na">supportsFetch</span><span class="p">:</span> <span class="dl">"</span><span class="s2">fetch</span><span class="dl">"</span> <span class="k">in</span> <span class="nb">window</span><span class="p">,</span>
  <span class="na">supportsCustomElements</span><span class="p">:</span> <span class="dl">"</span><span class="s2">customElements</span><span class="dl">"</span> <span class="k">in</span> <span class="nb">window</span><span class="p">,</span>
<span class="p">};</span>

<span class="c1">// Send to analytics (respecting privacy!)</span>
<span class="k">if </span><span class="p">(</span><span class="nb">navigator</span><span class="p">.</span><span class="nx">sendBeacon</span><span class="p">)</span> <span class="p">{</span>
  <span class="nb">navigator</span><span class="p">.</span><span class="nf">sendBeacon</span><span class="p">(</span><span class="dl">"</span><span class="s2">/api/browser-metrics</span><span class="dl">"</span><span class="p">,</span> <span class="nx">JSON</span><span class="p">.</span><span class="nf">stringify</span><span class="p">(</span><span class="nx">browserMetrics</span><span class="p">));</span>
<span class="p">}</span>
</div>

<h2 id="-making-legacy-support-beautiful">🎨 Making Legacy Support Beautiful</h2>

<p>When you do support older browsers, don’t make it feel like punishment:</p>

<h3 id="inclusive-design-patterns"><strong>Inclusive Design Patterns</strong></h3>

<div class="language-scss highlighter-rouge">
<span class="c1">// MIJUG-themed progressive enhancement</span>
<span class="nc">.navigation</span> <span class="p">{</span>
  <span class="c1">// Base styles that work everywhere</span>
  <span class="nl">display</span><span class="p">:</span> <span class="nb">block</span><span class="p">;</span>

  <span class="c1">// Enhanced styles for modern browsers</span>
  <span class="k"><a href="https://github.com/supports" class="user-mention">@supports</a></span> <span class="o">(</span><span class="nt">display</span><span class="nd">:</span> <span class="nt">flex</span><span class="o">)</span> <span class="p">{</span>
    <span class="nl">display</span><span class="p">:</span> <span class="nb">flex</span><span class="p">;</span>
    <span class="nl">gap</span><span class="p">:</span> <span class="m">1rem</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// ES6 module support indicator</span>
  <span class="nc">.js-modules</span> <span class="k">&amp;</span> <span class="p">{</span>
    <span class="c1">// Advanced interactions</span>
    <span class="nl">transition</span><span class="p">:</span> <span class="n">transform</span> <span class="m">0</span><span class="mi">.3s</span> <span class="nb">ease</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</div>

<h3 id="user-first-messaging"><strong>User-First Messaging</strong></h3>

<div class="language-html highlighter-rouge">
<span class="c">&lt;!-- Always include meaningful fallbacks --&gt;</span>
<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"feature-unavailable"</span> <span class="na">hidden</span><span class="nt">&gt;</span>
  <span class="nt">&lt;h3&gt;</span>Enhanced Features Not Available<span class="nt">&lt;/h3&gt;</span>
  <span class="nt">&lt;p&gt;</span>Your browser doesn't support some modern features, but core functionality remains fully available.<span class="nt">&lt;/p&gt;</span>
  <span class="nt">&lt;details&gt;</span>
    <span class="nt">&lt;summary&gt;</span>Learn more about browser compatibility<span class="nt">&lt;/summary&gt;</span>
    <span class="nt">&lt;p&gt;</span>Modern browsers offer enhanced security, performance, and features. Consider updating when possible.<span class="nt">&lt;/p&gt;</span>
  <span class="nt">&lt;/details&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</div>

<h2 id="-the-numbers-that-might-surprise-you">📊 The Numbers That Might Surprise You</h2>

<p>Based on 2025 browser usage data:</p>

<table>
  <thead>
    <tr>
      <th>Browser Support</th>
      <th>User Percentage</th>
      <th>Security Status</th>
      <th>Performance Impact</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>ES6+ Native</strong></td>
      <td>~85%</td>
      <td>✅ Current</td>
      <td>🚀 Optimal</td>
    </tr>
    <tr>
      <td><strong>ES6 via Polyfills</strong></td>
      <td>~10%</td>
      <td>⚠️ Mixed</td>
      <td>📈 Good</td>
    </tr>
    <tr>
      <td><strong>ES5 Only</strong></td>
      <td>~3%</td>
      <td>❌ Vulnerable</td>
      <td>📉 Limited</td>
    </tr>
    <tr>
      <td><strong>No JavaScript</strong></td>
      <td>~2%</td>
      <td>➖ N/A</td>
      <td>🐌 Basic</td>
    </tr>
  </tbody>
</table>

<p><strong>The takeaway?</strong> You’re potentially serving vulnerable JavaScript to 13% of users who could benefit from a browser upgrade nudge.</p>

<h2 id="-tools-and-resources-for-implementation">🚀 Tools and Resources for Implementation</h2>

<h3 id="essential-development-tools"><strong>Essential Development Tools</strong></h3>

<div class="language-bash highlighter-rouge">
<span class="c"># Modern build pipeline setup with Rollup</span>
npm <span class="nb">install</span> <span class="nt">--save-dev</span> rollup @rollup/plugin-babel @rollup/plugin-node-resolve @rollup/plugin-terser
npm <span class="nb">install</span> <span class="nt">--save-dev</span> @babel/preset-env @babel/core
npm <span class="nb">install</span> <span class="nt">--save-dev</span> @typescript-eslint/eslint-plugin
npm <span class="nb">install</span> <span class="nt">--save-dev</span> @axe-core/playwright  <span class="c"># Testing support</span>

<span class="c"># Browser compatibility validation</span>
npm run <span class="nb">test</span>:browser-compat  <span class="c"># Multi-browser validation</span>
npm run <span class="nb">test</span>:a11y           <span class="c"># WCAG 2.1 AA compliance</span>
</div>

<h3 id="packagejson-scripts-for-rollup-builds"><strong>Package.json Scripts for Rollup Builds</strong></h3>

<div class="language-json highlighter-rouge">
<span class="p">{</span><span class="w">
  </span><span class="nl">"scripts"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"build"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rollup -c"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"build:watch"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rollup -c -w"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"build:modern"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rollup -c --environment BUILD:modern"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"build:legacy"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rollup -c --environment BUILD:legacy"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span>
</div>

<h3 id="recommended-libraries"><strong>Recommended Libraries</strong></h3>

<ul>
  <li>
<strong>Browserslist</strong>: Define target browsers with data</li>
  <li>
<strong>Core-js</strong>: Selective polyfills for missing features</li>
  <li>
<strong>Lighthouse CI</strong>: Automated performance monitoring</li>
  <li>
<strong>Can I Use</strong>: Real-time compatibility data</li>
</ul>

<h2 id="-your-action-plan-what-to-do-right-now">🎯 Your Action Plan: What to Do Right Now</h2>

<h3 id="week-1-assessment"><strong>Week 1: Assessment</strong></h3>

<ol>
  <li>
<strong>Audit your analytics</strong>: What browsers are actually visiting?</li>
  <li>
<strong>Test legacy browsers</strong>: Fire up BrowserStack or similar</li>
  <li>
<strong>Identify critical features</strong>: What breaks without ES6?</li>
</ol>

<h3 id="week-2-strategy"><strong>Week 2: Strategy</strong></h3>

<ol>
  <li>
<strong>Choose your approach</strong>: Universal support vs. modern-first</li>
  <li>
<strong>Set up build pipeline</strong>: Rollup with dual outputs</li>
  <li>
<strong>Plan messaging</strong>: How will you handle unsupported browsers?</li>
</ol>

<h3 id="week-3-implementation"><strong>Week 3: Implementation</strong></h3>

<ol>
  <li>
<strong>Implement detection</strong>: Feature detection over browser sniffing</li>
  <li>
<strong>Create fallbacks</strong>: Ensure core functionality always works</li>
  <li>
<strong>Add monitoring</strong>: Track what’s actually happening in production</li>
</ol>

<h3 id="week-4-optimization"><strong>Week 4: Optimization</strong></h3>

<ol>
  <li>
<strong>Monitor performance</strong>: Measure the real impact</li>
  <li>
<strong>Gather feedback</strong>: Are users successfully upgrading?</li>
  <li>
<strong>Iterate</strong>: Adjust based on real user data</li>
</ol>

<h2 id="-the-philosophical-question">💭 The Philosophical Question</h2>

<p>Here’s what keeps me up at night: <strong>Are we helping users by supporting outdated, vulnerable browsers, or are we enabling digital harm?</strong></p>

<p>There’s no easy answer, but I’ve landed on this principle: <strong>Inform, don’t abandon.</strong></p>

<p>Provide the information and gentle encouragement for users to upgrade, but maintain basic functionality for those who can’t or won’t. It’s about respecting user agency while promoting digital safety.</p>

<h2 id="-whats-your-story">🌟 What’s Your Story?</h2>

<p>I shared my navigation menu nightmare - now I want to hear yours:</p>

<ul>
  <li>Have you encountered similar browser compatibility challenges?</li>
  <li>How do you balance modern development with legacy support?</li>
  <li>What’s your take on the security vs. usability trade-off?</li>
</ul>

<p><strong>Drop a comment below</strong> and let’s start a conversation about the real-world decisions we face as developers in 2025.</p>

<hr>

<h2 id="-related-resources">🔗 Related Resources</h2>

<ul>
  <li>
<strong><a href="https://www.w3.org/WAI/WCAG21/AA/">WCAG 2.1 AA Guidelines</a></strong>: Ensuring usability across all browsers</li>
  <li>
<strong><a href="https://caniuse.com/es6-module">Can I Use ES6 Modules</a></strong>: Live browser support data</li>
  <li>
<strong><a href="https://securityheaders.com/">Security Headers Scanner</a></strong>: Check your site’s security posture</li>
  <li>
<strong><a href="https://browserslist.dev/">Browserslist</a></strong>: Configure target browsers intelligently</li>
</ul>

<p><em>Want more insights on modern web development? Subscribe to our newsletter for weekly tips on JavaScript, usability, and performance optimization.</em></p>
</div>
<div class="post-categories">
    <strong>Categories:</strong> <a href="/category/web-development" class="category-link">web-development</a>,<a href="/category/tutorial" class="category-link">tutorial</a>
</div>
<footer class="post-footer">
    <div class="post-nav">
<div class="prev-post">
        <a rel="prev" href="/posts/2025/10/02/september-2025-a-look-back/" class="prev-link"> ← September 2025: A Look Back at the Sessions </a>
      </div>
<div class="next-post">
        <a rel="next" href="/posts/2025/10/06/typescript-jekyll-workspace/" class="next-link"> Building a Modern TypeScript + Jekyll Workspace in 2025 → </a>
      </div>
</div>
  </footer>

  <a class="u-url" rel="canonical" href="/blog/browser-support-es5-es6-guide/" hidden></a>
</article>

<style>
  .post-meta-separator {
    color: #666;
  }

  .post-description {
    font-style: italic;
    color: #666;
    margin-bottom: 1rem;
  }

  .post-tags {
    margin-bottom: 1rem;
  }

  .tag {
    background: #f0f0f0;
    padding: 0.2rem 0.5rem;
    border-radius: 0.25rem;
    font-size: 0.8rem;
    margin-right: 0.5rem;
    color: #555;
  }

  .post-categories {
    margin-top: 2rem;
    padding-top: 1rem;
    border-top: 1px solid #eee;
  }

  .category-link {
    text-decoration: none;
    color: #0066cc;
  }

  .category-link:hover {
    text-decoration: underline;
  }

  .post-nav {
    display: flex;
    justify-content: space-between;
    margin-top: 2rem;
    padding-top: 1rem;
    border-top: 1px solid #eee;
  }

  .prev-link,
  .next-link {
    text-decoration: none;
    color: #0066cc;
    font-weight: 500;
  }

  .prev-link:hover,
  .next-link:hover {
    text-decoration: underline;
  }

  .next-post {
    text-align: right;
  }
</style>
</div>
      <div class="ad-container" id="ad-slot-1" data-ad-slot="12345678"></div>
    </main>

    <footer class="site-footer h-card">
      <data class="u-url" href="/"></data>
      <div class="wrapper">
        <div class="footer-col-wrapper">
          <div class="footer-col footer-col-1">
            <a href="/terms-of-service.html">Terms of Service</a><br>
            <a href="/privacy-policy.html">Privacy Policy</a>
          </div>
          <div class="footer-col footer-col-2">
            <a href="/contact/">Contact Us</a>
          </div>
          <div class="footer-col footer-col-3">
            <p>
              © 2025
              <a rel="external nofollow" href="https://share.google/8Ir6br641K4uU74l2">Kranson Enterprises</a><br>
                  subscribe
              <a href="/feed.xml">via RSS<svg class="svg-icon">
                  <use xlink:href="/assets/minima-social-icons.svg#rss"></use></svg></a>
            </p>
          </div>
        </div>
      </div>
    </footer>

    

    <script>
      // Enhanced module support detection and navigation management
      (function() {
        'use strict';

        var html = document.documentElement;
        var supportsModules = 'noModule' in HTMLScriptElement.prototype;

        // Update HTML classes for navigation management
        html.className = html.className.replace("no-js", "js");

        if (supportsModules) {
          html.classList.add('supports-modules');
        } else {
          html.classList.add('no-modules');
          // Show legacy browser notice for commerce functionality
          document.write('<div class="legacy-browser-notice" role="alert"><strong>No Commerce Available</strong><span class="notice-detail">Your browser does not support modern features required for commerce functionality.</span></div>');
        }

        // Only initialize advanced navigation for modern browsers
        if (!supportsModules) {
          return; // Exit early for legacy browsers
        }

        // Advanced navigation logic for modern browsers
        var toggleBtn = document.querySelector('.nav-toggle');
        var nav = document.getElementById('primary-navigation');
        var statusEl = document.getElementById('menu-status');
        var body = document.body;

        if (!toggleBtn || !nav || !statusEl) {
          console.warn('Navigation elements not found - falling back to basic behavior');
          return;
        }

        nav.classList.add('nav-overlay');

        function toggleNavigation() {
          var isExpanded = toggleBtn.getAttribute('aria-expanded') === 'true';

          if (isExpanded) {
            nav.classList.remove('nav-visible');
            toggleBtn.setAttribute('aria-expanded', 'false');
            nav.setAttribute('aria-hidden', 'true');
            toggleBtn.textContent = 'Menu';
            statusEl.textContent = 'Menu closed';
            body.classList.remove('nav-open');
          } else {
            nav.classList.add('nav-visible');
            toggleBtn.setAttribute('aria-expanded', 'true');
            nav.removeAttribute('aria-hidden');
            toggleBtn.textContent = 'Close';
            statusEl.textContent = 'Menu opened';
            body.classList.add('nav-open');
          }
        }

        toggleBtn.addEventListener('click', function(e) {
          e.preventDefault();
          toggleNavigation();
        });

        document.addEventListener('click', function(e) {
          if (toggleBtn.getAttribute('aria-expanded') !== 'true') return;

          if ((!nav.contains(e.target) && !toggleBtn.contains(e.target)) ||
              (e.target.tagName === 'A' && nav.contains(e.target))) {
            toggleNavigation();
          }
        });

        document.addEventListener('keydown', function(e) {
          if (e.key === 'Escape' && toggleBtn.getAttribute('aria-expanded') === 'true') {
            toggleNavigation();
            toggleBtn.focus();
          }
        });

        nav.setAttribute('aria-hidden', 'true');
      })();
    </script>

    
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }

      gtag('consent', 'default', {
        analytics_storage: 'denied',
        ad_storage: 'denied',
        ad_user_data: 'denied',
        ad_personalization: 'denied',
      });

      gtag('js', new Date());
      gtag('config', 'G-W1M1N0DCD4');
    </script>

    <script src="https://www.googletagmanager.com/gtag/js?id=G-W1M1N0DCD4" crossorigin="anonymous" async></script>
    

    <!-- Cookie consent system -->
    <!-- Google AdSense with MIJUG Cookie Consent Integration -->
<script>
  (function() {
    'use strict';

    // Privacy and consent checks
    if (window.doNotTrack === '1' ||
        navigator.doNotTrack === '1' ||
        navigator.doNotTrack === 'yes' ||
        navigator.msDoNotTrack === '1' ||
        localStorage.getItem('mijug-ads-disabled') === 'true') {
      return;
    }

    // Development environment bypass
    if (location.hostname === 'localhost' ||
        location.hostname === '127.0.0.1' ||
        location.protocol === 'file:') {
      console.log('[MIJUG AdSense] Skipped - Development environment');
      return;
    }

    // URL parameter bypass for testing
    const urlParams = new URLSearchParams(window.location.search);
    if (urlParams.get('skip-ads') === 'true') {
      console.log('[MIJUG AdSense] Skipped - URL parameter override');
      return;
    }

    // Initialize consent mode with MIJUG defaults
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    window.gtag = gtag;

    // Set default consent state (MIJUG privacy-first approach)
    gtag('consent', 'default', {
      ad_storage: 'denied',
      ad_user_data: 'denied',
      ad_personalization: 'denied',
      analytics_storage: 'denied'
    });

    // Load AdSense with error handling
    function loadAdSense() {
      try {
        const script = document.createElement('script');
        script.async = true;
        script.crossOrigin = 'anonymous';
        script.src = 'https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3383458876439157';
        script.onerror = function() {
          console.warn('[MIJUG AdSense] Failed to load AdSense script');
        };
        document.head.appendChild(script);

        console.log('[MIJUG AdSense] AdSense script loaded');

      } catch (error) {
        console.warn('[MIJUG AdSense] Initialization error:', error);
      }
    }

    // MIJUG cookie consent integration
    if (typeof window.MijugCookieConsent !== 'undefined') {
      window.MijugCookieConsent.onReady(function(consent) {
        if (consent.advertising) {
          // Update consent for AdSense
          gtag('consent', 'update', {
            ad_storage: 'granted',
            ad_user_data: 'granted',
            ad_personalization: consent.personalization ? 'granted' : 'denied'
          });

          loadAdSense();
        } else {
          console.log('[MIJUG AdSense] Skipped - Advertising cookies declined');
        }
      });

      // Handle consent changes
      window.MijugCookieConsent.onConsentChange(function(consent) {
        gtag('consent', 'update', {
          ad_storage: consent.advertising ? 'granted' : 'denied',
          ad_user_data: consent.advertising ? 'granted' : 'denied',
          ad_personalization: (consent.advertising && consent.personalization) ? 'granted' : 'denied'
        });
      });
    } else {
      // Fallback: Load with denied consent if no cookie system
      console.log('[MIJUG AdSense] Loading with default denied consent - no cookie system detected');
      loadAdSense();
    }

  })();
</script>

    <!-- Cookie Consent Banner for GDPR Compliance -->
<div id="cookie-consent-banner" class="cookie-consent-banner" role="complementary" aria-label="Cookie consent banner" aria-live="polite" style="display: none">
  <div class="cookie-consent-content">
    <div class="cookie-consent-text">
      <p>
        <strong>🍪 Cookie Notice</strong><br>
        This website uses cookies for Google AdSense and analytics to improve
        your experience.
        <a href="/privacy-policy.html" class="cookie-policy-link">Learn more in our Privacy Policy</a>
      </p>
    </div>
    <div class="cookie-consent-buttons">
      <button id="accept-cookies" class="cookie-btn cookie-btn-accept" onclick="acceptCookies()">
        Accept All Cookies
      </button>
      <button id="decline-cookies" class="cookie-btn cookie-btn-decline" onclick="declineCookies()">
        Decline Optional Cookies
      </button>
      <button id="cookie-settings" class="cookie-btn cookie-btn-settings" onclick="showCookieSettings()">
        Cookie Settings
      </button>
    </div>
  </div>
</div>

<!-- Cookie Settings Modal - Using MIJUG Theme Pattern -->
<div id="cookie-settings-modal" class="cookie-modal" style="display: none" role="dialog" aria-modal="true" aria-labelledby="cookie-settings-title">
  <div class="cookie-modal-content mijug-highlight">
    <div class="cookie-modal-header">
      <h3 id="cookie-settings-title">Cookie Settings</h3>
      <button class="cookie-modal-close" onclick="closeCookieSettings()" aria-label="Close cookie settings dialog" type="button">
        ×
      </button>
    </div>
    <div class="cookie-modal-body">
      <p class="cookie-modal-description">
        Customize your cookie preferences. Essential cookies are required for basic site functionality and cannot be disabled.
      </p>

      <div class="cookie-category">
        <div class="cookie-category-header">
          <h4>Essential Cookies</h4>
          <label class="cookie-toggle" for="essential-cookies" aria-label="Essential cookies (required)">
            <input type="checkbox" id="essential-cookies" checked disabled>
            <span class="cookie-slider cookie-slider-disabled"></span>
          </label>
        </div>
        <p class="cookie-category-description">Required for basic site functionality. These cannot be disabled.</p>
      </div>

      <div class="cookie-category">
        <div class="cookie-category-header">
          <h4>Analytics Cookies</h4>
          <label class="cookie-toggle" for="analytics-cookies" aria-label="Analytics cookies (optional)">
            <input type="checkbox" id="analytics-cookies">
            <span class="cookie-slider"></span>
          </label>
        </div>
        <p class="cookie-category-description">
          Help us understand how visitors interact with our website via Google Analytics.
          No personally identifiable information is collected.
        </p>
      </div>

      <div class="cookie-category">
        <div class="cookie-category-header">
          <h4>Advertising Cookies</h4>
          <label class="cookie-toggle" for="advertising-cookies" aria-label="Advertising cookies (optional)">
            <input type="checkbox" id="advertising-cookies">
            <span class="cookie-slider"></span>
          </label>
        </div>
        <p class="cookie-category-description">
          Used by Google AdSense to display relevant advertisements.
          Helps support the website through ad revenue.
        </p>
      </div>
    </div>
    <div class="cookie-modal-footer">
      <button class="cookie-btn cookie-btn-accept" onclick="savePreferences()" type="button">
        Save Preferences
      </button>
      <button class="cookie-btn cookie-btn-settings" onclick="closeCookieSettings()" type="button">
        Cancel
      </button>
    </div>
  </div>
</div>
<style>
  html body #cookie-consent-banner.cookie-consent-banner,
  html body div#cookie-consent-banner.cookie-consent-banner {
    position: fixed !important;
    bottom: 0 !important;
    left: 0 !important;
    right: 0 !important;
    background: #2c3e50 !important;
    color: white !important;
    padding: 1rem !important;
    box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.3) !important;
    z-index: 2147483647 !important;
    border-top: 3px solid #3498db !important;
    display: none !important;
    visibility: visible !important;
    opacity: 1 !important;
    width: 100% !important;
    min-height: 80px !important;
    box-sizing: border-box !important;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;
    font-size: 14px !important;
    line-height: 1.4 !important;
    transform: translateZ(0) !important;
    will-change: transform !important;
  }

  /* Enhanced visibility for all child elements */
  html body #cookie-consent-banner.cookie-consent-banner *,
  html body div#cookie-consent-banner.cookie-consent-banner * {
    visibility: visible !important;
    opacity: inherit !important;
    display: initial !important;
  }

  /* Content layout with enhanced specificity */
  html body .cookie-consent-content {
    max-width: 1200px !important;
    margin: 0 auto !important;
    display: flex !important;
    align-items: center !important;
    justify-content: space-between !important;
    gap: 1rem !important;
    flex-wrap: wrap !important;
  }

  html body .cookie-consent-text {
    flex: 1 !important;
    min-width: 200px !important;
  }

  html body .cookie-consent-text p {
    margin: 0 !important;
    font-size: 0.9rem !important;
    line-height: 1.4 !important;
    color: white !important;
  }

  html body .cookie-policy-link {
    color: #74c0fc !important;
    text-decoration: underline !important;
  }

  html body .cookie-policy-link:hover {
    color: #a3d5ff !important;
  }

  html body .cookie-consent-buttons {
    display: flex !important;
    gap: 0.5rem !important;
    flex-wrap: wrap !important;
    min-width: 200px !important;
  }

  html body .cookie-btn {
    padding: 0.5rem 1rem !important;
    border: none !important;
    border-radius: 4px !important;
    cursor: pointer !important;
    font-size: 0.85rem !important;
    font-weight: 500 !important;
    transition: all 0.2s ease !important;
    white-space: nowrap !important;
    min-width: 80px !important;
  }

  html body .cookie-btn-accept {
    background: #1e8449 !important;
    color: white !important;
  }

  html body .cookie-btn-accept:hover {
    background: #196f3d !important;
  }

  html body .cookie-btn-decline {
    background: #c0392b !important;
    color: white !important;
  }

  html body .cookie-btn-decline:hover {
    background: #a93226 !important;
  }

  html body .cookie-btn-settings {
    background: #5d6d7e !important;
    color: white !important;
  }

  html body .cookie-btn-settings:hover {
    background: #515a5a !important;
  }

  /* Modal with enhanced specificity - hidden by default */
  html body .cookie-modal {
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    width: 100% !important;
    height: 100% !important;
    background: rgba(0, 0, 0, 0.7) !important;
    z-index: 2147483646 !important;
    display: none !important;
    align-items: center !important;
    justify-content: center !important;
    -webkit-backdrop-filter: blur(2px) !important;
    backdrop-filter: blur(2px) !important;
  }

  html body .cookie-modal-content {
    background: white !important;
    border-radius: 8px !important;
    padding: 2rem !important;
    max-width: 500px !important;
    width: 90% !important;
    max-height: 80vh !important;
    overflow-y: auto !important;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3) !important;
  }

  /* Responsive design with enhanced breakpoints */
  @media (max-width: 768px) {
    html body .cookie-consent-content {
      flex-direction: column !important;
      align-items: stretch !important;
      gap: 0.75rem !important;
    }

    html body .cookie-consent-buttons {
      justify-content: center !important;
      gap: 0.25rem !important;
    }

    html body .cookie-btn {
      flex: 1 !important;
      min-width: 0 !important;
      font-size: 0.8rem !important;
      padding: 0.4rem 0.8rem !important;
    }

    html body .cookie-modal-content {
      margin: 1rem !important;
      padding: 1.5rem !important;
    }
  }

  @media (max-width: 480px) {
    html body .cookie-consent-buttons {
      flex-direction: column !important;
    }

    html body .cookie-btn {
      width: 100% !important;
    }
  }

  /* Print media - hide banner */
  @media print {
    html body #cookie-consent-banner.cookie-consent-banner,
    html body .cookie-modal {
      display: none !important;
    }
  }

  /* High contrast mode support */
  @media (prefers-contrast: high) {
    html body #cookie-consent-banner.cookie-consent-banner {
      border: 2px solid white !important;
    }
  }

  /* Reduced motion support */
  @media (prefers-reduced-motion: reduce) {
    html body .cookie-btn {
      transition: none !important;
    }
  }
</style>
<style>
  /**
   * Enhanced modal management with aggressive visibility enforcement
   * Following MIJUG .NET workspace performance and accessibility standards
   */
  const modalManager = {
    show() {
      const modal = getElement(CONFIG.MODAL_ELEMENT_ID);
      if (!modal) {
        console.error('❌ Cookie settings modal element not found');
        return;
      }

      // Load current preferences before showing
      this.loadCurrentPreferences();

      // Use z-index higher than site header but compatible with theme
      modal.style.cssText = `
        display: flex !important;
        visibility: visible !important;
        opacity: 1 !important;
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        width: 100% !important;
        height: 100% !important;
        background: rgba(0, 0, 0, 0.85) !important;
        z-index: 1002 !important;
        align-items: center !important;
        justify-content: center !important;
        padding: 1rem !important;
        box-sizing: border-box !important;
      `;

      modal.setAttribute('aria-hidden', 'false');
      modal.classList.add('cookie-modal-visible');

      // Set up focus management
      focusManager.trapFocus(modal);

      // Prevent body scroll when modal is open using existing MIJUG class
      document.body.classList.add('nav-open');

      console.log('✅ Cookie settings modal displayed');
    },

    hide() {
      const modal = getElement(CONFIG.MODAL_ELEMENT_ID);
      if (!modal) return;

      modal.style.display = 'none';
      modal.setAttribute('aria-hidden', 'true');
      modal.classList.remove('cookie-modal-visible');

      // Remove focus trap
      if (modal._removeFocusTrap) {
        modal._removeFocusTrap();
      }

      // Restore body scroll using existing MIJUG class
      document.body.classList.remove('nav-open');

      // Return focus to settings button
      const settingsButton = getElement('cookie-settings');
      if (settingsButton) {
        settingsButton.focus();
      }

      console.log('✅ Cookie settings modal hidden');
    },

    loadCurrentPreferences() {
      const preferences = cookieUtils.get(CONFIG.COOKIE_PREFERENCES_KEY);

      let analytics = false;
      let advertising = false;

      if (preferences) {
        try {
          const prefs = JSON.parse(preferences);
          analytics = prefs.analytics || false;
          advertising = prefs.advertising || false;
        } catch (e) {
          console.warn('⚠️ Error parsing saved preferences:', e);
        }
      }

      // Update checkboxes with retry mechanism
      setTimeout(() => {
        const analyticsCheckbox = getElement('analytics-cookies');
        const advertisingCheckbox = getElement('advertising-cookies');

        if (analyticsCheckbox) {
          analyticsCheckbox.checked = analytics;
        }
        if (advertisingCheckbox) {
          advertisingCheckbox.checked = advertising;
        }

        console.log('📋 Current preferences loaded:', { analytics, advertising });
      }, 100);
    }
  };
</style>
<script>
  /**
   * Cookie Consent Management System
   * Streamlined implementation using MIJUG theme styles
   * Following MIJUG .NET Workspace coding standards
   */
  (function () {
    'use strict';

    // Configuration constants following MIJUG naming conventions
    const CONFIG = {
      COOKIE_CONSENT_KEY: 'mijug-cookie-consent',
      COOKIE_PREFERENCES_KEY: 'mijug-cookie-preferences',
      CONSENT_EXPIRY_DAYS: 365,
      FOCUS_TRAP_SELECTORS: 'button, [href], input:not([type=hidden]), select, textarea, [tabindex]:not([tabindex="-1"])',
      BANNER_ELEMENT_ID: 'cookie-consent-banner',
      MODAL_ELEMENT_ID: 'cookie-settings-modal'
    };

    // Performance-optimized element caching
    const elementCache = new Map();

    /**
     * Performance-optimized DOM element retrieval with caching
     * @param {string} id - Element ID
     * @returns {HTMLElement|null} - Cached or fresh DOM element
     */
    function getElement(id) {
      if (!elementCache.has(id)) {
        elementCache.set(id, document.getElementById(id));
      }
      return elementCache.get(id);
    }

    /**
     * Modern cookie utilities with enhanced error handling
     */
    const cookieUtils = {
      get(name) {
        try {
          const cookies = document.cookie.split(';');
          for (const cookie of cookies) {
            const [key, value] = cookie.trim().split('=');
            if (key === name) {
              return decodeURIComponent(value);
            }
          }
          return null;
        } catch (error) {
          console.warn(`⚠️ Error reading cookie ${name}:`, error);
          return null;
        }
      },

      set(name, value, days) {
        try {
          const expires = new Date(Date.now() + days * 24 * 60 * 60 * 1000).toUTCString();
          const cookieString = `${name}=${encodeURIComponent(value)};expires=${expires};path=/;SameSite=Strict`;
          document.cookie = cookieString;
          console.log(`🍪 Cookie set: ${name}=${value}`);
        } catch (error) {
          console.error(`❌ Error setting cookie ${name}:`, error);
        }
      },

      clear(name) {
        try {
          const clearCookieVariations = [
            `${name}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`,
            `${name}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/; domain=${window.location.hostname};`,
            `${name}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/; domain=.${window.location.hostname};`
          ];

          clearCookieVariations.forEach(cookieString => {
            document.cookie = cookieString;
          });

          console.log(`🗑️ Cookie cleared: ${name}`);
        } catch (error) {
          console.warn(`⚠️ Error clearing cookie ${name}:`, error);
        }
      }
    };

    /**
     * Enhanced banner visibility management using existing theme z-index patterns
     */
    const bannerManager = {
      show() {
        const banner = getElement(CONFIG.BANNER_ELEMENT_ID);
        const modal = getElement(CONFIG.MODAL_ELEMENT_ID);

        if (!banner) {
          console.error('❌ Cookie consent banner element not found');
          return;
        }

        // Use z-index that works with existing MIJUG theme
        banner.style.cssText = `
          display: block !important;
          visibility: visible !important;
          opacity: 1 !important;
          position: fixed !important;
          bottom: 0 !important;
          left: 0 !important;
          right: 0 !important;
          z-index: 1001 !important;
          background: #2c3e50 !important;
          color: white !important;
          padding: 1rem !important;
          box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.3) !important;
          border-top: 3px solid #3498db !important;
          min-height: 80px !important;
          width: 100vw !important;
          box-sizing: border-box !important;
          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;
        `;

        banner.setAttribute('aria-hidden', 'false');
        banner.classList.add('cookie-banner-visible');

        // Ensure modal stays hidden
        if (modal) {
          modal.style.display = 'none';
          modal.setAttribute('aria-hidden', 'true');
        }

        console.log('✅ Cookie consent banner displayed');
      },

      hide() {
        const banner = getElement(CONFIG.BANNER_ELEMENT_ID);
        if (banner) {
          banner.style.display = 'none';
          banner.setAttribute('aria-hidden', 'true');
          banner.classList.remove('cookie-banner-visible');
          console.log('✅ Cookie consent banner hidden');
        }
      }
    };

    /**
     * Enhanced modal management leveraging MIJUG theme patterns
     */
    const modalManager = {
      show() {
        const modal = getElement(CONFIG.MODAL_ELEMENT_ID);
        if (!modal) {
          console.error('❌ Cookie settings modal element not found');
          return;
        }

        // Load current preferences before showing
        this.loadCurrentPreferences();

        // Use z-index higher than site header but compatible with theme
        modal.style.cssText = `
          display: flex !important;
          visibility: visible !important;
          opacity: 1 !important;
          position: fixed !important;
          top: 0 !important;
          left: 0 !important;
          width: 100% !important;
          height: 100% !important;
          background: rgba(0, 0, 0, 0.85) !important;
          z-index: 1002 !important;
          align-items: center !important;
          justify-content: center !important;
          padding: 1rem !important;
          box-sizing: border-box !important;
        `;

        modal.setAttribute('aria-hidden', 'false');
        modal.classList.add('cookie-modal-visible');

        // Set up focus management
        focusManager.trapFocus(modal);

        // Prevent body scroll when modal is open using existing MIJUG class
        document.body.classList.add('nav-open');

        console.log('✅ Cookie settings modal displayed');
      },

      hide() {
        const modal = getElement(CONFIG.MODAL_ELEMENT_ID);
        if (!modal) return;

        modal.style.display = 'none';
        modal.setAttribute('aria-hidden', 'true');
        modal.classList.remove('cookie-modal-visible');

        // Remove focus trap
        if (modal._removeFocusTrap) {
          modal._removeFocusTrap();
        }

        // Restore body scroll using existing MIJUG class
        document.body.classList.remove('nav-open');

        // Return focus to settings button
        const settingsButton = getElement('cookie-settings');
        if (settingsButton) {
          settingsButton.focus();
        }

        console.log('✅ Cookie settings modal hidden');
      },

      loadCurrentPreferences() {
        const preferences = cookieUtils.get(CONFIG.COOKIE_PREFERENCES_KEY);

        let analytics = false;
        let advertising = false;

        if (preferences) {
          try {
            const prefs = JSON.parse(preferences);
            analytics = prefs.analytics || false;
            advertising = prefs.advertising || false;
          } catch (e) {
            console.warn('⚠️ Error parsing saved preferences:', e);
          }
        }

        // Update checkboxes with retry mechanism
        setTimeout(() => {
          const analyticsCheckbox = getElement('analytics-cookies');
          const advertisingCheckbox = getElement('advertising-cookies');

          if (analyticsCheckbox) {
            analyticsCheckbox.checked = analytics;
          }
          if (advertisingCheckbox) {
            advertisingCheckbox.checked = advertising;
          }

          console.log('📋 Current preferences loaded:', { analytics, advertising });
        }, 100);
      }
    };

    /**
     * Consent state management with enhanced logic
     */
    const consentManager = {
      shouldShowConsent() {
        try {
          // Testing override - highest priority
          if (window.forceShowCookieConsent === true) {
            console.log('🧪 Testing override: Forcing cookie consent display');
            return true;
          }

          // URL parameter override
          const urlParams = new URLSearchParams(window.location.search);
          if (urlParams.get('force-cookie-consent') === 'true') {
            console.log('🧪 URL parameter override: Forcing cookie consent display');
            return true;
          }

          // Development mode detection
          const isDevelopment = window.location.hostname === 'localhost' ||
                               window.location.hostname === '127.0.0.1' ||
                               window.location.hostname.endsWith('.local');

          if (isDevelopment) {
            console.log('🔧 Development mode detected - showing cookie consent');
            return true;
          }

          // Check existing consent
          const consentCookie = cookieUtils.get(CONFIG.COOKIE_CONSENT_KEY);
          if (consentCookie !== null && consentCookie !== '') {
            console.log('✅ Existing consent found:', consentCookie);
            return false;
          }

          console.log('📋 No existing consent - showing banner for GDPR compliance');
          return true;
        } catch (error) {
          console.warn('⚠️ Error checking consent status:', error);
          return true;
        }
      },

      hasConsent() {
        return cookieUtils.get(CONFIG.COOKIE_CONSENT_KEY) !== null;
      },

      hasAnalyticsConsent() {
        const preferences = cookieUtils.get(CONFIG.COOKIE_PREFERENCES_KEY);
        if (!preferences) return false;
        try {
          return JSON.parse(preferences).analytics === true;
        } catch {
          return false;
        }
      },

      hasAdvertisingConsent() {
        const preferences = cookieUtils.get(CONFIG.COOKIE_PREFERENCES_KEY);
        if (!preferences) return false;
        try {
          return JSON.parse(preferences).advertising === true;
        } catch {
          return false;
        }
      }
    };

    /**
     * Analytics integration with localhost safety
     */
    const analyticsManager = {
      loadAnalytics() {
        if (consentManager.hasAnalyticsConsent() && typeof gtag !== 'undefined') {
          gtag('consent', 'update', { analytics_storage: 'granted' });
          console.log('📊 Analytics loaded with user consent');
        } else {
          console.log('📊 Analytics not loaded (no consent or localhost)');
        }
      },

      loadAdSense() {
        if (consentManager.hasAdvertisingConsent() && typeof gtag !== 'undefined') {
          gtag('consent', 'update', {
            ad_storage: 'granted',
            ad_user_data: 'granted',
            ad_personalization: 'granted',
          });
          console.log('📢 AdSense loaded with user consent');
        } else {
          console.log('📢 AdSense not loaded (no consent or localhost)');
        }
      }
    };

    /**
     * Focus management for accessibility compliance
     */
    const focusManager = {
      trapFocus(modal) {
        const focusableEls = modal.querySelectorAll(CONFIG.FOCUS_TRAP_SELECTORS);
        const firstFocusableEl = focusableEls[0];
        const lastFocusableEl = focusableEls[focusableEls.length - 1];

        const handleKeydown = (e) => {
          if (e.key === 'Tab') {
            if (e.shiftKey && document.activeElement === firstFocusableEl) {
              e.preventDefault();
              lastFocusableEl?.focus();
            } else if (!e.shiftKey && document.activeElement === lastFocusableEl) {
              e.preventDefault();
              firstFocusableEl?.focus();
            }
          } else if (e.key === 'Escape') {
            closeCookieSettings();
          }
        };

        modal.addEventListener('keydown', handleKeydown);
        modal._removeFocusTrap = () => modal.removeEventListener('keydown', handleKeydown);

        // Focus close button first for better UX
        requestAnimationFrame(() => {
          const closeButton = modal.querySelector('.cookie-modal-close');
          if (closeButton) {
            closeButton.focus();
          } else {
            firstFocusableEl?.focus();
          }
        });
      }
    };

    /**
     * Global button handlers with enhanced error handling
     */
    window.acceptCookies = function () {
      try {
        const preferences = { analytics: true, advertising: true };
        cookieUtils.set(CONFIG.COOKIE_CONSENT_KEY, 'accepted', CONFIG.CONSENT_EXPIRY_DAYS);
        cookieUtils.set(CONFIG.COOKIE_PREFERENCES_KEY, JSON.stringify(preferences), CONFIG.CONSENT_EXPIRY_DAYS);

        bannerManager.hide();
        analyticsManager.loadAnalytics();
        analyticsManager.loadAdSense();
        console.log('✅ All cookies accepted');
      } catch (error) {
        console.error('❌ Error accepting cookies:', error);
      }
    };

    window.declineCookies = function () {
      try {
        const preferences = { analytics: false, advertising: false };
        cookieUtils.set(CONFIG.COOKIE_CONSENT_KEY, 'declined', CONFIG.CONSENT_EXPIRY_DAYS);
        cookieUtils.set(CONFIG.COOKIE_PREFERENCES_KEY, JSON.stringify(preferences), CONFIG.CONSENT_EXPIRY_DAYS);

        bannerManager.hide();
        console.log('❌ Optional cookies declined');
      } catch (error) {
        console.error('❌ Error declining cookies:', error);
      }
    };

    window.showCookieSettings = function () {
      try {
        console.log('🔧 Attempting to show cookie settings modal...');
        modalManager.show();
      } catch (error) {
        console.error('❌ Error showing cookie settings:', error);
      }
    };

    window.closeCookieSettings = function () {
      try {
        modalManager.hide();
      } catch (error) {
        console.error('❌ Error closing cookie settings:', error);
      }
    };

    window.savePreferences = function () {
      try {
        const analyticsCheckbox = getElement('analytics-cookies');
        const advertisingCheckbox = getElement('advertising-cookies');

        const analytics = analyticsCheckbox?.checked || false;
        const advertising = advertisingCheckbox?.checked || false;
        const preferences = { analytics, advertising };

        cookieUtils.set(CONFIG.COOKIE_CONSENT_KEY, 'customized', CONFIG.CONSENT_EXPIRY_DAYS);
        cookieUtils.set(CONFIG.COOKIE_PREFERENCES_KEY, JSON.stringify(preferences), CONFIG.CONSENT_EXPIRY_DAYS);

        bannerManager.hide();
        modalManager.hide();

        if (analytics) analyticsManager.loadAnalytics();
        if (advertising) analyticsManager.loadAdSense();

        console.log('💾 Custom preferences saved:', preferences);
        showSaveConfirmation();
      } catch (error) {
        console.error('❌ Error saving preferences:', error);
      }
    };

    /**
     * Save confirmation using MIJUG theme patterns
     */
    function showSaveConfirmation() {
      const notification = document.createElement('div');
      notification.className = 'mijug-highlight favorite-toast favorite-toast-success favorite-toast-visible';
      notification.style.cssText = `
        position: fixed !important;
        top: 20px !important;
        right: 20px !important;
        z-index: 1003 !important;
        max-width: 300px !important;
        padding: 1rem 1.5rem !important;
        border-radius: 8px !important;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3) !important;
        animation: slideInRight 0.3s ease-out !important;
      `;

      notification.innerHTML = `
        <div style="display: flex; align-items: center; gap: 0.5rem;">
          <span style="font-size: 1.2rem;">✅</span>
          <span>Cookie preferences saved successfully!</span>
        </div>
      `;

      notification.setAttribute('role', 'alert');
      notification.setAttribute('aria-live', 'polite');

      document.body.appendChild(notification);

      setTimeout(() => {
        if (notification.parentNode) {
          notification.parentNode.removeChild(notification);
        }
      }, 4000);
    }

    /**
     * Enhanced initialization with multiple retry strategies
     */
    function initialize() {
      console.log('🚀 Cookie consent system initializing...');

      // Ensure modal is hidden on initialization
      const modal = getElement(CONFIG.MODAL_ELEMENT_ID);
      if (modal) {
        modal.style.display = 'none';
        modal.setAttribute('aria-hidden', 'true');
      }

      if (consentManager.shouldShowConsent()) {
        bannerManager.show();

        // Retry mechanisms for theme compatibility
        setTimeout(() => bannerManager.show(), 100);
        setTimeout(() => bannerManager.show(), 500);
      } else if (consentManager.hasConsent()) {
        analyticsManager.loadAnalytics();
        analyticsManager.loadAdSense();
      }
    }

    /**
     * Testing mode with enhanced visibility enforcement
     */
    function initializeTestingMode() {
      console.log('🧪 TESTING MODE: Enhanced cookie consent forcing');

      // Clear existing cookies
      const cookiesToClear = [CONFIG.COOKIE_CONSENT_KEY, CONFIG.COOKIE_PREFERENCES_KEY];
      cookiesToClear.forEach(cookieName => cookieUtils.clear(cookieName));

      // Set testing flags
      window.forceShowCookieConsent = true;

      setTimeout(() => {
        bannerManager.show();
        console.log('🧪 Testing banner display forced');
      }, 50);

      // Disable testing mode after timeout
      setTimeout(() => {
        window.forceShowCookieConsent = false;
        console.log('🧪 Testing mode disabled');
      }, 30000);
    }

    // Event listeners
    document.addEventListener('DOMContentLoaded', () => {
      try {
        initialize();

        if (window.location.search.includes('force-cookie-consent=true') ||
            window.location.hostname === 'localhost') {
          initializeTestingMode();
        }
      } catch (error) {
        console.error('❌ Error during cookie consent initialization:', error);
      }
    });

    // Modal click-outside handler
    document.addEventListener('click', (event) => {
      const modal = getElement(CONFIG.MODAL_ELEMENT_ID);
      if (modal && event.target === modal) {
        closeCookieSettings();
      }
    });

  })();
</script>


  </body>
</html>
