<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <script src="/assets/js/storage-access.js?v=20250909000248"></script>
    <meta
      name="google-adsense-account"
      content="ca-pub-3383458876439157"
    />
    
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    
    <!-- Navigation and ordering metadata -->
    <meta name="docs-nav-order" content="18" />
    <meta name="docs-section" content="documentation" />
    
        <meta name="priority-doc" content="true" />
      
    
    
    <!-- Disable ability to print or save -->
    <script>
      window.print = function () {
        console.log('Skip printing');
      };
      window.addEventListener('keydown', function(event) {
       if (event.keyCode === 80 && (event.ctrlKey || event.metaKey) && !event.altKey && (!event.shiftKey || window.chrome || window.opera)) {
        event.preventDefault();
        if (event.stopImmediatePropagation) {
            event.stopImmediatePropagation();
        } else {
            event.stopPropagation();
        }
        return;
       }
        if (event.ctrlKey && (event.key === "p" || event.key === "s")) {
           event.preventDefault();
        }
      }, true);
    </script>
    
    
    <title>
      Mermaid Test Runner | My Information Just Under Glass
    </title>
    <meta
      name="description"
      content="This document describes the dedicated test runner for Mermaid diagram functionality in the MIJUG .NET workspace."
    />
    
    <meta name="version" content="Sep 02, 2025" />
    
    
    <link rel="stylesheet" href="/assets/main.css?v=20250909000248" />
    <link rel="stylesheet" href="/assets/css/inp-optimizations.css?v=20250909000248" />
    <link
      rel="canonical"
      href="https://www.mijug.net/docs/mermaid-test-runner/"
    />
    <link
      rel="alternate"
      type="application/rss+xml"
      title="My Information Just Under Glass"
      href="/feed.xml"
    />
    
    <link
      rel="icon"
      type="image/svg+xml"
      href="/assets/logo-mijug-96x96.png"
    />
    
    <link
      rel="shortcut icon"
      type="image/x-icon"
      href="/favicon.ico"
    />
    <link rel="manifest" href="/manifest.webmanifest" />
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Mermaid Test Runner | My Information Just Under Glass</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Mermaid Test Runner" />
<meta name="author" content="Bob Kranson" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Dedicated test runner for Mermaid diagram functionality with multi-browser support and comprehensive testing options" />
<meta property="og:description" content="Dedicated test runner for Mermaid diagram functionality with multi-browser support and comprehensive testing options" />
<link rel="canonical" href="https://www.mijug.net/docs/mermaid-test-runner/" />
<meta property="og:url" content="https://www.mijug.net/docs/mermaid-test-runner/" />
<meta property="og:site_name" content="My Information Just Under Glass" />
<meta property="og:image" content="https://www.mijug.net/assets/logo-mijug-96x96.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-09-09T00:02:48-04:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://www.mijug.net/assets/logo-mijug-96x96.png" />
<meta property="twitter:title" content="Mermaid Test Runner" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Bob Kranson"},"dateModified":"2025-09-01T21:29:05-04:00","datePublished":"2025-09-09T00:02:48-04:00","description":"Dedicated test runner for Mermaid diagram functionality with multi-browser support and comprehensive testing options","headline":"Mermaid Test Runner","image":"https://www.mijug.net/assets/logo-mijug-96x96.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.mijug.net/docs/mermaid-test-runner/"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://www.mijug.net/assets/logo-mijug-96x96.png"},"name":"Bob Kranson"},"url":"https://www.mijug.net/docs/mermaid-test-runner/"}</script>
<!-- End Jekyll SEO tag -->

  </head>
  
    <!-- oncontextmenu return false disables right click context menu -->
    <body oncontextmenu="return false;">
  
    <header class="site-header" role="banner">
      <div class="wrapper">
        <a class="site-title long-title" rel="home" href="/">
          
          <img src="/assets/logo-mijug-96x96.png" alt="My Information Just Under Glass" width="50" height="50">
           My Information Just Under Glass
        </a>

        <nav class="site-nav" role="navigation" aria-label="Main navigation">
          <input type="checkbox" id="header-nav-trigger" class="nav-trigger" title="Toggle header navigation" aria-label="Toggle navigation menu">
          <label for="header-nav-trigger" aria-label="Open navigation menu">
            <span class="menu-icon">
              <svg viewbox="0 0 18 15" width="18px" height="15px" role="img" aria-label="Menu icon">
                <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"></path>
              </svg>
            </span>
          </label>

          <div class="trigger">
            <a class="page-link" href="/about/" aria-label="About MIJUG">About</a>
            <button class="nav-button" popovertarget="mobile-navigation" popovertargetaction="show" type="button" aria-label="Open additional navigation menu" aria-haspopup="true" aria-expanded="false">
              Navigation
            </button>
          </div>
        </nav>
      </div>
    </header>
    <nav popover id="mobile-navigation" class="site-nav" role="dialog" aria-labelledby="nav-heading" aria-modal="true">
      <h2 id="nav-heading" class="sr-only">Additional Navigation</h2>
      <button class="nav-button" popovertarget="mobile-navigation" popovertargetaction="hide" type="button" aria-label="Close navigation menu">
        Close
      </button>

      <div class="popover-content">
        <!-- Posts Section -->
        <div class="popover-section">
          <h3 class="popover-heading">Posts</h3>
          <ul class="nav-list" role="list">
            <li>
              <a class="page-link" href="/blog/" aria-label="View blog posts">Blog</a>
            </li>
            <li>
              <a class="page-link" href="/contact/" aria-label="Contact MIJUG">Contact Us</a>
            </li>
          </ul>
        </div>

        <!-- Documentation Section -->
        <div class="popover-section">
          <h3 class="popover-heading">
            <a class="page-link" href="/docs/" aria-label="View documentation index">Documentation</a>
          </h3>
          <ul class="nav-list" role="list" aria-label="Documentation pages">
            
            
            
            <li>
              <a class="page-link" href="/docs/welcome-mijug-workspace/" aria-label="View Welcome to MIJUG .NET Workspace documentation">
                Welcome to MIJUG .NET Workspace
              </a>
            </li>
            
          </ul>
        </div>

        <!-- Categories Section -->
        
        <div class="popover-section">
          <h3 class="popover-heading">Categories</h3>
          <ul class="nav-list" role="list" aria-label="Blog post categories">
            
            <li>
              <a class="page-link" href="/category/announcements" aria-label="View Announcements category with 5 posts">
                Announcements
                <span class="count" aria-hidden="true">(5)</span>
              </a>
            </li>
            
            <li>
              <a class="page-link" href="/category/linux" aria-label="View Linux category with 2 posts">
                Linux
                <span class="count" aria-hidden="true">(2)</span>
              </a>
            </li>
            
            <li>
              <a class="page-link" href="/category/documentation" aria-label="View Documentation category with 1 posts">
                Documentation
                <span class="count" aria-hidden="true">(1)</span>
              </a>
            </li>
            
            <li>
              <a class="page-link" href="/category/navigation" aria-label="View Navigation category with 1 posts">
                Navigation
                <span class="count" aria-hidden="true">(1)</span>
              </a>
            </li>
            
            <li>
              <a class="page-link" href="/category/getting-started" aria-label="View Getting-started category with 3 posts">
                Getting-started
                <span class="count" aria-hidden="true">(3)</span>
              </a>
            </li>
            
            <li>
              <a class="page-link" href="/category/digital-legacy" aria-label="View Digital-legacy category with 1 posts">
                Digital-legacy
                <span class="count" aria-hidden="true">(1)</span>
              </a>
            </li>
            
            <li>
              <a class="page-link" href="/category/guides" aria-label="View Guides category with 2 posts">
                Guides
                <span class="count" aria-hidden="true">(2)</span>
              </a>
            </li>
            
            <li>
              <a class="page-link" href="/category/history" aria-label="View History category with 2 posts">
                History
                <span class="count" aria-hidden="true">(2)</span>
              </a>
            </li>
            
            <li>
              <a class="page-link" href="/category/home" aria-label="View Home category with 1 posts">
                Home
                <span class="count" aria-hidden="true">(1)</span>
              </a>
            </li>
            
            <li>
              <a class="page-link" href="/category/technology" aria-label="View Technology category with 1 posts">
                Technology
                <span class="count" aria-hidden="true">(1)</span>
              </a>
            </li>
            
            <li>
              <a class="page-link" href="/category/labor-day" aria-label="View Labor-day category with 1 posts">
                Labor-day
                <span class="count" aria-hidden="true">(1)</span>
              </a>
            </li>
            
            <li>
              <a class="page-link" href="/category/security" aria-label="View Security category with 2 posts">
                Security
                <span class="count" aria-hidden="true">(2)</span>
              </a>
            </li>
            
            <li>
              <a class="page-link" href="/category/windows" aria-label="View Windows category with 1 posts">
                Windows
                <span class="count" aria-hidden="true">(1)</span>
              </a>
            </li>
            
            <li>
              <a class="page-link" href="/category/encryption" aria-label="View Encryption category with 1 posts">
                Encryption
                <span class="count" aria-hidden="true">(1)</span>
              </a>
            </li>
            
            <li>
              <a class="page-link" href="/category/legacy" aria-label="View Legacy category with 1 posts">
                Legacy
                <span class="count" aria-hidden="true">(1)</span>
              </a>
            </li>
            
            <li>
              <a class="page-link" href="/category/writing" aria-label="View Writing category with 1 posts">
                Writing
                <span class="count" aria-hidden="true">(1)</span>
              </a>
            </li>
            
            <li>
              <a class="page-link" href="/category/tools" aria-label="View Tools category with 1 posts">
                Tools
                <span class="count" aria-hidden="true">(1)</span>
              </a>
            </li>
            
            <li>
              <a class="page-link" href="/category/evolution" aria-label="View Evolution category with 1 posts">
                Evolution
                <span class="count" aria-hidden="true">(1)</span>
              </a>
            </li>
            
            <li>
              <a class="page-link" href="/category/productivity" aria-label="View Productivity category with 1 posts">
                Productivity
                <span class="count" aria-hidden="true">(1)</span>
              </a>
            </li>
            
          </ul>
        </div>
        

        <!-- Tags Section -->
        
        <div class="popover-section">
          <h3 class="popover-heading">Tags</h3>
          <ul class="nav-list" role="list" aria-label="Blog post tags">
             
            <li>
              <a class="page-link" href="/tag/appliances" aria-label="View posts tagged with appliances (1 posts)">
                #appliances
                <span class="count" aria-hidden="true">(1)</span>
              </a>
            </li>
            
            <li>
              <a class="page-link" href="/tag/backup" aria-label="View posts tagged with backup (2 posts)">
                #backup
                <span class="count" aria-hidden="true">(2)</span>
              </a>
            </li>
            
            <li>
              <a class="page-link" href="/tag/bitlocker" aria-label="View posts tagged with bitlocker (1 posts)">
                #bitlocker
                <span class="count" aria-hidden="true">(1)</span>
              </a>
            </li>
            
            <li>
              <a class="page-link" href="/tag/computers" aria-label="View posts tagged with computers (1 posts)">
                #computers
                <span class="count" aria-hidden="true">(1)</span>
              </a>
            </li>
            
            <li>
              <a class="page-link" href="/tag/copyright" aria-label="View posts tagged with copyright (1 posts)">
                #copyright
                <span class="count" aria-hidden="true">(1)</span>
              </a>
            </li>
            
            <li>
              <a class="page-link" href="/tag/cpus" aria-label="View posts tagged with cpus (1 posts)">
                #cpus
                <span class="count" aria-hidden="true">(1)</span>
              </a>
            </li>
            
            <li>
              <a class="page-link" href="/tag/digital-legacy" aria-label="View posts tagged with digital-legacy (1 posts)">
                #digital-legacy
                <span class="count" aria-hidden="true">(1)</span>
              </a>
            </li>
            
            <li>
              <a class="page-link" href="/tag/diy" aria-label="View posts tagged with diy (1 posts)">
                #diy
                <span class="count" aria-hidden="true">(1)</span>
              </a>
            </li>
            
            <li>
              <a class="page-link" href="/tag/docs" aria-label="View posts tagged with docs (1 posts)">
                #docs
                <span class="count" aria-hidden="true">(1)</span>
              </a>
            </li>
            
            <li>
              <a class="page-link" href="/tag/drm" aria-label="View posts tagged with drm (1 posts)">
                #drm
                <span class="count" aria-hidden="true">(1)</span>
              </a>
            </li>
            
          </ul>
        </div>
        
      </div>
    </nav>
    <main class="page-content" aria-label="Content">
      <div class="wrapper">
<article class="post">
  <header class="post-header">
    <h1 class="post-title">Mermaid Test Runner</h1>
  </header>

  <div class="post-content">
<p>This document describes the dedicated test runner for Mermaid diagram functionality in the MIJUG .NET workspace.</p>

<h2 id="overview">Overview</h2>

<p>The <code class="language-plaintext highlighter-rouge">scripts/test-mermaid-diagrams.js</code> script provides a specialized test runner that focuses exclusively on Mermaid diagram rendering and functionality. It automatically discovers all mermaid-related test files and provides flexible browser testing options.</p>

<h2 id="features">Features</h2>

<ul>
  <li>
<strong>Automatic Test Discovery</strong>: Finds all mermaid-related test files in the e2e directory</li>
  <li>
<strong>Multi-Browser Support</strong>: Tests with Chromium, Firefox, and WebKit</li>
  <li>
<strong>Browser Management</strong>: Automatic browser installation and verification</li>
  <li>
<strong>Flexible Options</strong>: Headed/headless modes, debug mode, custom worker counts</li>
  <li>
<strong>Error Handling</strong>: Robust error handling with helpful messages</li>
  <li>
<strong>Cross-Platform</strong>: Works on Linux, macOS, and Windows</li>
</ul>

<h2 id="usage">Usage</h2>

<h3 id="basic-commands">Basic Commands</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Run all mermaid tests with default settings (Chromium, headless)</span>
npm run <span class="nb">test</span>:mermaid

<span class="c"># Run with browser UI visible (helpful for debugging)</span>
npm run <span class="nb">test</span>:mermaid:headed

<span class="c"># Run in debug mode (step-by-step execution)</span>
npm run <span class="nb">test</span>:mermaid:debug

<span class="c"># Run with Firefox browser</span>
npm run <span class="nb">test</span>:mermaid:firefox
</code></pre></div></div>

<h3 id="advanced-options">Advanced Options</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Run with specific browser and options</span>
node scripts/test-mermaid-diagrams.js <span class="nt">--project</span><span class="o">=</span>webkit <span class="nt">--workers</span><span class="o">=</span>2 <span class="nt">--verbose</span>

<span class="c"># Ensure browsers are installed first</span>
node scripts/test-mermaid-diagrams.js <span class="nt">--ensure-browsers</span>

<span class="c"># Run in headed mode with debug</span>
node scripts/test-mermaid-diagrams.js <span class="nt">--headed</span> <span class="nt">--debug</span>

<span class="c"># Get help and see all available options</span>
node scripts/test-mermaid-diagrams.js <span class="nt">--help</span>
</code></pre></div></div>

<h2 id="command-line-options">Command Line Options</h2>

<table>
  <thead>
    <tr>
      <th>Option</th>
      <th>Description</th>
      <th>Example</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">--ensure-browsers</code></td>
      <td>Install browsers before testing</td>
      <td><code class="language-plaintext highlighter-rouge">--ensure-browsers</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">--headed</code></td>
      <td>Run with browser UI visible</td>
      <td><code class="language-plaintext highlighter-rouge">--headed</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">--debug</code></td>
      <td>Step-by-step debug mode</td>
      <td><code class="language-plaintext highlighter-rouge">--debug</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">--project=&lt;name&gt;</code></td>
      <td>Specify browser (chromium, firefox, webkit)</td>
      <td><code class="language-plaintext highlighter-rouge">--project=firefox</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">--workers=&lt;num&gt;</code></td>
      <td>Number of parallel workers (default: 1)</td>
      <td><code class="language-plaintext highlighter-rouge">--workers=2</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">--verbose</code></td>
      <td>Enable verbose output</td>
      <td><code class="language-plaintext highlighter-rouge">--verbose</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">--help</code></td>
      <td>Show help message</td>
      <td><code class="language-plaintext highlighter-rouge">--help</code></td>
    </tr>
  </tbody>
</table>

<h2 id="test-files-covered">Test Files Covered</h2>

<p>The script automatically discovers and runs these test files:</p>

<ol>
  <li>
<strong><code class="language-plaintext highlighter-rouge">e2e/mermaid-basic-visual.spec.ts</code></strong>
    <ul>
      <li>Tests basic mermaid diagram rendering</li>
      <li>Validates SVG generation and visual elements</li>
    </ul>
  </li>
  <li>
<strong><code class="language-plaintext highlighter-rouge">e2e/mermaid-default-layout.spec.ts</code></strong>
    <ul>
      <li>Tests mermaid rendering in default page layout</li>
      <li>Validates sequence diagrams and syntax error handling</li>
    </ul>
  </li>
  <li>
<strong><code class="language-plaintext highlighter-rouge">e2e/mermaid-diagrams-visual.spec.ts</code></strong>
    <ul>
      <li>Tests visual diagram sample page</li>
      <li>Validates multiple diagram types and SVG content</li>
    </ul>
  </li>
  <li>
<strong><code class="language-plaintext highlighter-rouge">e2e/mermaid-documentation.spec.ts</code></strong>
    <ul>
      <li>Tests documentation pages</li>
      <li>Validates quick start, configuration guide, and examples</li>
    </ul>
  </li>
</ol>

<h2 id="browser-compatibility">Browser Compatibility</h2>

<table>
  <thead>
    <tr>
      <th>Browser</th>
      <th>Support Level</th>
      <th>Notes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Chromium</strong></td>
      <td>‚úÖ Full</td>
      <td>Default browser, fastest execution</td>
    </tr>
    <tr>
      <td><strong>Firefox</strong></td>
      <td>‚úÖ Full</td>
      <td>Good compatibility, slightly slower</td>
    </tr>
    <tr>
      <td><strong>WebKit</strong></td>
      <td>‚úÖ Full</td>
      <td>Safari engine, best for macOS testing</td>
    </tr>
  </tbody>
</table>

<h2 id="error-handling">Error Handling</h2>

<p>The script provides comprehensive error handling:</p>

<ul>
  <li>
<strong>Browser Detection</strong>: Automatically detects available browsers</li>
  <li>
<strong>Fallback Support</strong>: Falls back to available browsers if requested browser isn‚Äôt available</li>
  <li>
<strong>Installation Help</strong>: Guides users to install missing browsers</li>
  <li>
<strong>Clear Messages</strong>: Provides helpful error messages and suggestions</li>
</ul>

<h2 id="integration-with-cicd">Integration with CI/CD</h2>

<p>The script is designed to work in continuous integration environments:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Example GitHub Actions usage</span>
<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Run Mermaid Tests</span>
  <span class="na">run</span><span class="pi">:</span> <span class="s">npm run test:mermaid</span>

<span class="c1"># With specific browser</span>
<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Run Mermaid Tests (Firefox)</span>
  <span class="na">run</span><span class="pi">:</span> <span class="s">npm run test:mermaid:firefox</span>

<span class="c1"># With browser installation</span>
<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Run Mermaid Tests (All Browsers)</span>
  <span class="na">run</span><span class="pi">:</span> <span class="pi">|</span>
    <span class="s">npm run test:mermaid -- --ensure-browsers --project=chromium</span>
    <span class="s">npm run test:mermaid -- --project=firefox</span>
    <span class="s">npm run test:mermaid -- --project=webkit</span>
</code></pre></div></div>

<h2 id="performance-considerations">Performance Considerations</h2>

<ul>
  <li>
<strong>Single Worker Default</strong>: Uses 1 worker by default for stability</li>
  <li>
<strong>Network Idle</strong>: Waits for network idle state before testing</li>
  <li>
<strong>Timeout Handling</strong>: Includes appropriate timeouts for browser operations</li>
  <li>
<strong>Resource Cleanup</strong>: Properly cleans up browser instances</li>
</ul>

<h2 id="debugging">Debugging</h2>

<p>For debugging mermaid rendering issues:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Run in debug mode with browser UI</span>
npm run <span class="nb">test</span>:mermaid:debug

<span class="c"># Run specific test file in headed mode</span>
node scripts/test-mermaid-diagrams.js <span class="nt">--headed</span> <span class="nt">--project</span><span class="o">=</span>chromium e2e/mermaid-basic-visual.spec.ts

<span class="c"># Enable verbose output for detailed logs</span>
node scripts/test-mermaid-diagrams.js <span class="nt">--verbose</span> <span class="nt">--headed</span>
</code></pre></div></div>

<h2 id="configuration">Configuration</h2>

<p>The script respects the Playwright configuration in <code class="language-plaintext highlighter-rouge">playwright.config.ts</code> but allows overrides via command line arguments.</p>

<h2 id="output-example">Output Example</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>üé® Mermaid Diagrams Test Runner Starting...
‚ÑπÔ∏è  üîß Ensuring browsers are installed...
‚úÖ All browsers are ready for testing!
‚ÑπÔ∏è  üìä Browser Engine Summary:
‚ÑπÔ∏è    üéØ (selected) chromium - Available
‚ÑπÔ∏è    ‚úÖ firefox - Available
‚ÑπÔ∏è    ‚úÖ webkit - Available
‚ÑπÔ∏è  üöÄ Starting Mermaid diagram tests...
‚ÑπÔ∏è  Found 4 mermaid test files:
üîç   - e2e/mermaid-basic-visual.spec.ts
üîç   - e2e/mermaid-default-layout.spec.ts
üîç   - e2e/mermaid-diagrams-visual.spec.ts
üîç   - e2e/mermaid-documentation.spec.ts

Running 7 tests using 1 worker
  ‚úì  All tests passed
‚úÖ ‚úÖ All Mermaid tests completed successfully!
</code></pre></div></div>

<h2 id="troubleshooting">Troubleshooting</h2>

<h3 id="common-issues">Common Issues</h3>

<ol>
  <li>
<strong>Browser Not Found</strong>
    <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="c"># Solution: Install browsers</span>
npm run <span class="nb">test</span>:mermaid <span class="nt">--</span> <span class="nt">--ensure-browsers</span>
</code></pre></div>    </div>
  </li>
  <li>
<strong>Permission Errors</strong>
    <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="c"># Solution: Run with proper permissions or use skipIfNoPermissions</span>
node scripts/test-mermaid-diagrams.js <span class="nt">--ensure-browsers</span> <span class="nt">--skip-if-no-permissions</span>
</code></pre></div>    </div>
  </li>
  <li>
<strong>Network Timeouts</strong>
    <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="c"># Solution: Increase timeout or check network connectivity</span>
node scripts/test-mermaid-diagrams.js <span class="nt">--workers</span><span class="o">=</span>1
</code></pre></div>    </div>
  </li>
  <li>
    <p><strong>iNotify Watches Limit Exceeded (Linux)</strong></p>

    <p><strong>Error</strong>: <code class="language-plaintext highlighter-rouge">Listen::Error::INotifyMaxWatchesExceeded: Unable to monitor directories for changes because iNotify max watches exceeded</code></p>

    <p><strong>Symptoms</strong>: Jekyll server fails to start with file watching errors, preventing the test server from running.</p>

    <p><strong>Solution</strong>: Increase the iNotify watches limit on Linux systems:</p>

    <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="c"># Check current limit</span>
<span class="nb">cat</span> /proc/sys/fs/inotify/max_user_watches

<span class="c"># Increase limit permanently (requires sudo)</span>
<span class="nb">echo </span>fs.inotify.max_user_watches<span class="o">=</span>524288 | <span class="nb">sudo tee</span> <span class="nt">-a</span> /etc/sysctl.conf
<span class="nb">sudo </span>sysctl <span class="nt">-p</span>

<span class="c"># Verify the change</span>
<span class="nb">cat</span> /proc/sys/fs/inotify/max_user_watches
</code></pre></div>    </div>

    <p><strong>Alternative temporary fix</strong>:</p>
    <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="c"># Temporary increase (until reboot)</span>
<span class="nb">sudo </span>sysctl fs.inotify.max_user_watches<span class="o">=</span>524288
</code></pre></div>    </div>

    <p><strong>Background</strong>: This issue occurs when Jekyll tries to watch too many files for changes. The default Linux limit is typically 8,192 watches, but large projects with many files can exceed this limit. Setting it to 524,288 provides ample headroom for most development scenarios.</p>
  </li>
</ol>

<h2 id="future-enhancements">Future Enhancements</h2>

<p>Potential improvements to the script:</p>

<ul>
  <li>
<strong>Parallel Browser Testing</strong>: Run multiple browsers simultaneously</li>
  <li>
<strong>Visual Regression Testing</strong>: Screenshot comparison for diagram rendering</li>
  <li>
<strong>Performance Metrics</strong>: Measure diagram rendering performance</li>
  <li>
<strong>Custom Test Patterns</strong>: Allow custom glob patterns for test discovery</li>
  <li>
<strong>Report Generation</strong>: Generate detailed HTML reports</li>
  <li>
<strong>Integration Testing</strong>: Test mermaid with different Jekyll configurations</li>
</ul>

<h2 id="related-documentation">Related Documentation</h2>

<ul>
  <li><a href="/docs/mermaid-configuration-guide/">Mermaid Configuration Guide</a></li>
  <li><a href="/docs/mermaid-quick-start/">Mermaid Quick Start</a></li>
  <li><a href="/docs/mermaid-examples/">Mermaid Examples</a></li>
  <li><a href="https://github.com/devopsbob/mijug-dot-net-project/blob/main/playwright.config.ts" rel="external noopener noreferrer" target="_blank">Playwright Configuration</a></li>
  <li><a href="https://github.com/devopsbob/mijug-dot-net-project/blob/main/scripts/test-runner.js" rel="external noopener noreferrer" target="_blank">Main Test Runner</a></li>
</ul>
</div>
</article>
</div>
    </main>
    <footer class="site-footer h-card">
      <data class="u-url" href="/"></data>
      <div class="wrapper">
        <div class="footer-col-wrapper">
          <div class="footer-col footer-col-1">
            <a href="/terms-of-service.html">Terms of Service</a><br>
            <a href="/privacy-policy.html">Privacy Policy</a>
          </div>
          <div class="footer-col footer-col-2">
            <a href="/contact/">Contact Us</a>
          </div>
          <div class="footer-col footer-col-3">
            <p>
              ¬© 2025
              <a rel="external nofollow" href="https://share.google/8Ir6br641K4uU74l2">Kranson Enterprises</a><br>
              ¬†¬†¬†¬†subscribe
              <a href="/feed.xml">via RSS<svg class="svg-icon">
                  <use xlink:href="/assets/minima-social-icons.svg#rss"></use></svg></a>
            </p>
          </div>
        </div>
      </div>
    </footer>

    
    <!-- Google Analytics with Consent Mode -->
    <script>
      // Initialize gtag with default consent settings
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }

      // Default consent to denied for GDPR compliance
      gtag('consent', 'default', {
        analytics_storage: 'denied',
        ad_storage: 'denied',
        ad_user_data: 'denied',
        ad_personalization: 'denied',
      });

      gtag('js', new Date());
      gtag('config', 'G-W1M1N0DCD4');
    </script>

    <!-- Load Google Analytics -->
    <script src="https://www.googletagmanager.com/gtag/js?id=G-W1M1N0DCD4" crossorigin="anonymous"></script>
    

    <!-- Google AdSense -->
    <!-- Google AdSense with Consent Mode Support -->
<script>
  // Initialize consent mode for AdSense
  window.dataLayer = window.dataLayer || [];
  function gtag() {
    dataLayer.push(arguments);
  }

  // Set default consent state
  gtag('consent', 'default', {
    ad_storage: 'denied',
    ad_user_data: 'denied',
    ad_personalization: 'denied',
  });
</script>

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3383458876439157" crossorigin="anonymous"></script>


    <!-- Cookie Consent Banner for GDPR Compliance -->
    <!-- Cookie Consent Banner for GDPR Compliance -->
<div id="cookie-consent-banner" class="cookie-consent-banner" role="complementary" aria-label="Cookie consent banner" aria-live="polite" style="display: none">
  <div class="cookie-consent-content">
    <div class="cookie-consent-text">
      <p>
        <strong>üç™ Cookie Notice</strong><br>
        This website uses cookies for Google AdSense and analytics to improve
        your experience.
        <a href="/privacy-policy.html" class="cookie-policy-link">Learn more in our Privacy Policy</a>
      </p>
    </div>
    <div class="cookie-consent-buttons">
      <button id="accept-cookies" class="cookie-btn cookie-btn-accept" onclick="acceptCookies()">
        Accept All Cookies
      </button>
      <button id="decline-cookies" class="cookie-btn cookie-btn-decline" onclick="declineCookies()">
        Decline Optional Cookies
      </button>
      <button id="cookie-settings" class="cookie-btn cookie-btn-settings" onclick="showCookieSettings()">
        Cookie Settings
      </button>
    </div>
  </div>
</div>

<!-- Cookie Settings Modal -->
<div id="cookie-settings-modal" class="cookie-modal" style="display: none" role="dialog" aria-modal="true" aria-labelledby="cookie-settings-title">
  <div class="cookie-modal-content">
    <div class="cookie-modal-header">
      <h3 id="cookie-settings-title">Cookie Settings</h3>
      <button class="cookie-modal-close" onclick="closeCookieSettings()" aria-label="Close cookie settings dialog">
        √ó
      </button>
    </div>
    <div class="cookie-modal-body">
      <div class="cookie-category">
        <div class="cookie-category-header">
          <h4>Essential Cookies</h4>
          <label class="cookie-toggle" for="essential-cookies">
            <input type="checkbox" id="essential-cookies" checked disabled>
            <span class="cookie-slider"></span>
          </label>
        </div>
        <p>Required for basic site functionality. These cannot be disabled.</p>
      </div>

      <div class="cookie-category">
        <div class="cookie-category-header">
          <h4>Analytics Cookies</h4>
          <label class="cookie-toggle" for="analytics-cookies">
            <input type="checkbox" id="analytics-cookies">
            <span class="cookie-slider"></span>
          </label>
        </div>
        <p>
          Help us understand how visitors interact with our website via Google
          Analytics.
        </p>
      </div>

      <div class="cookie-category">
        <div class="cookie-category-header">
          <h4>Advertising Cookies</h4>
          <label class="cookie-toggle" for="advertising-cookies">
            <input type="checkbox" id="advertising-cookies">
            <span class="cookie-slider"></span>
          </label>
        </div>
        <p>Used by Google AdSense to display relevant advertisements.</p>
      </div>
    </div>
    <div class="cookie-modal-footer">
      <button class="cookie-btn cookie-btn-accept" onclick="savePreferences()">
        Save Preferences
      </button>
      <button class="cookie-btn cookie-btn-decline" onclick="closeCookieSettings()">
        Cancel
      </button>
    </div>
  </div>
</div>

<script>
  // Cookie Consent Management
  (function () {
    'use strict';

    const COOKIE_CONSENT_KEY = 'mijug-cookie-consent';
    const COOKIE_PREFERENCES_KEY = 'mijug-cookie-preferences';
    const CONSENT_EXPIRY_DAYS = 365;

    // Check if user is from EU (simplified check)
    function isEUUser() {
      // In production, use a proper geolocation service
      // For now, show to all users for compliance
      return true;
    }

    // Get cookie value
    function getCookie(name) {
      const value = `; ${document.cookie}`;
      const parts = value.split(`; ${name}=`);
      if (parts.length === 2) return parts.pop().split(';').shift();
      return null;
    }

    // Set cookie
    function setCookie(name, value, days) {
      const expires = new Date();
      expires.setTime(expires.getTime() + days * 24 * 60 * 60 * 1000);
      document.cookie = `${name}=${value};expires=${expires.toUTCString()};path=/;SameSite=Strict`;
    }

    // Show cookie banner
    function showCookieBanner() {
      const banner = document.getElementById('cookie-consent-banner');
      if (banner) {
        banner.style.display = 'block';
        banner.setAttribute('aria-hidden', 'false');
      }
    }

    // Hide cookie banner
    function hideCookieBanner() {
      const banner = document.getElementById('cookie-consent-banner');
      if (banner) {
        banner.style.display = 'none';
        banner.setAttribute('aria-hidden', 'true');
      }
    }

    // Load Google Analytics conditionally
    function loadAnalytics() {
      if (hasAnalyticsConsent()) {
        // Load Google Analytics if consent given
        if (typeof gtag !== 'undefined') {
          gtag('consent', 'update', {
            analytics_storage: 'granted',
          });
        }
      }
    }

    // Load AdSense conditionally
    function loadAdSense() {
      if (hasAdvertisingConsent()) {
        // Load AdSense if consent given
        if (typeof gtag !== 'undefined') {
          gtag('consent', 'update', {
            ad_storage: 'granted',
            ad_user_data: 'granted',
            ad_personalization: 'granted',
          });
        }
      }
    }

    // Check consent status
    function hasConsent() {
      return getCookie(COOKIE_CONSENT_KEY) !== null;
    }

    function hasAnalyticsConsent() {
      const preferences = getCookie(COOKIE_PREFERENCES_KEY);
      if (!preferences) return false;
      try {
        const prefs = JSON.parse(preferences);
        return prefs.analytics === true;
      } catch {
        return false;
      }
    }

    function hasAdvertisingConsent() {
      const preferences = getCookie(COOKIE_PREFERENCES_KEY);
      if (!preferences) return false;
      try {
        const prefs = JSON.parse(preferences);
        return prefs.advertising === true;
      } catch {
        return false;
      }
    }

    // Focus trap for modal
    function trapFocus(modal) {
      const focusableSelectors = 'button, [href], input:not([type=hidden]), select, textarea, [tabindex]:not([tabindex="-1"])';
      const focusableEls = modal.querySelectorAll(focusableSelectors);
      const firstFocusableEl = focusableEls[0];
      const lastFocusableEl = focusableEls[focusableEls.length - 1];

      function handleTab(e) {
        if (e.key === 'Tab') {
          if (e.shiftKey) {
            if (document.activeElement === firstFocusableEl) {
              e.preventDefault();
              lastFocusableEl.focus();
            }
          } else {
            if (document.activeElement === lastFocusableEl) {
              e.preventDefault();
              firstFocusableEl.focus();
            }
          }
        }
      }

      function handleEscape(e) {
        if (e.key === 'Escape') {
          closeCookieSettings();
        }
      }

      modal.addEventListener('keydown', handleTab);
      modal.addEventListener('keydown', handleEscape);
      // Remove listeners on close
      modal._removeFocusTrap = function () {
        modal.removeEventListener('keydown', handleTab);
        modal.removeEventListener('keydown', handleEscape);
      };
    }

    // Global functions for buttons
    window.acceptCookies = function () {
      const preferences = {
        analytics: true,
        advertising: true,
      };
      setCookie(COOKIE_CONSENT_KEY, 'accepted', CONSENT_EXPIRY_DAYS);
      setCookie(
        COOKIE_PREFERENCES_KEY,
        JSON.stringify(preferences),
        CONSENT_EXPIRY_DAYS
      );
      hideCookieBanner();
      loadAnalytics();
      loadAdSense();
    };

    window.declineCookies = function () {
      const preferences = {
        analytics: false,
        advertising: false,
      };
      setCookie(COOKIE_CONSENT_KEY, 'declined', CONSENT_EXPIRY_DAYS);
      setCookie(
        COOKIE_PREFERENCES_KEY,
        JSON.stringify(preferences),
        CONSENT_EXPIRY_DAYS
      );
      hideCookieBanner();
    };

    window.showCookieSettings = function () {
      const modal = document.getElementById('cookie-settings-modal');
      if (modal) {
        // Load current preferences
        const preferences = getCookie(COOKIE_PREFERENCES_KEY);
        if (preferences) {
          try {
            const prefs = JSON.parse(preferences);
            document.getElementById('analytics-cookies').checked =
              prefs.analytics || false;
            document.getElementById('advertising-cookies').checked =
              prefs.advertising || false;
          } catch {
            // Default to false if parsing fails
          }
        }
        modal.style.display = 'block';
        modal.setAttribute('aria-hidden', 'false');
        // Focus management: focus first button
        setTimeout(function () {
          const firstBtn = modal.querySelector('button, [href], input:not([type=hidden]), select, textarea, [tabindex]:not([tabindex="-1"])');
          if (firstBtn) firstBtn.focus();
        }, 0);
        trapFocus(modal);
      }
    };

    window.closeCookieSettings = function () {
      const modal = document.getElementById('cookie-settings-modal');
      if (modal) {
        modal.style.display = 'none';
        modal.setAttribute('aria-hidden', 'true');
        if (modal._removeFocusTrap) modal._removeFocusTrap();
        // Return focus to settings button
        const settingsBtn = document.getElementById('cookie-settings');
        if (settingsBtn) settingsBtn.focus();
      }
    };

    window.savePreferences = function () {
      const analytics = document.getElementById('analytics-cookies').checked;
      const advertising = document.getElementById(
        'advertising-cookies'
      ).checked;

      const preferences = {
        analytics: analytics,
        advertising: advertising,
      };

      setCookie(COOKIE_CONSENT_KEY, 'customized', CONSENT_EXPIRY_DAYS);
      setCookie(
        COOKIE_PREFERENCES_KEY,
        JSON.stringify(preferences),
        CONSENT_EXPIRY_DAYS
      );

      hideCookieBanner();
      closeCookieSettings();

      if (analytics) loadAnalytics();
      if (advertising) loadAdSense();
    };

    // Initialize on DOM ready
    document.addEventListener('DOMContentLoaded', function () {
      if (isEUUser() && !hasConsent()) {
        showCookieBanner();
      } else if (hasConsent()) {
        loadAnalytics();
        loadAdSense();
      }
    });

    // Close modal when clicking outside
    window.onclick = function (event) {
      const modal = document.getElementById('cookie-settings-modal');
      if (event.target === modal) {
        closeCookieSettings();
      }
    };
  })();
</script>

<style>
  /* Cookie Consent Banner Styles */
  .cookie-consent-banner {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    background: #2c3e50;
    color: white;
    padding: 1rem;
    box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
    z-index: 10000;
    border-top: 3px solid #3498db;
  }

  .cookie-consent-content {
    max-width: 1200px;
    margin: 0 auto;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 1rem;
  }

  .cookie-consent-text {
    flex: 1;
  }

  .cookie-consent-text p {
    margin: 0;
    font-size: 0.9rem;
    line-height: 1.4;
  }

  .cookie-policy-link {
    color: #74c0fc; /* Improved contrast ratio of 5.18:1 for WCAG AA compliance across all browsers */
    text-decoration: underline;
  }

  .cookie-policy-link:hover {
    color: #2980b9;
  }

  .cookie-consent-buttons {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
  }

  .cookie-btn {
    padding: 0.5rem 1rem;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-size: 0.85rem;
    font-weight: 500;
    transition: all 0.2s ease;
    white-space: nowrap;
  }

  .cookie-btn-accept {
    background: #1e8449; /* WCAG AA compliant: 4.6:1 contrast ratio */
    color: white;
  }

  .cookie-btn-accept:hover {
    background: #196f3d; /* Darker shade for hover */
  }

  .cookie-btn-decline {
    background: #c0392b; /* WCAG AA compliant: 4.8:1 contrast ratio */
    color: white;
  }

  .cookie-btn-decline:hover {
    background: #a93226; /* Darker shade for hover */
  }

  .cookie-btn-settings {
    background: #5d6d7e; /* WCAG AA compliant: 4.7:1 contrast ratio */
    color: white;
  }

  .cookie-btn-settings:hover {
    background: #515a5a; /* Darker shade for hover */
  }

  /* Cookie Settings Modal */
  .cookie-modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.7);
    z-index: 10001;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .cookie-modal-content {
    background: white;
    border-radius: 8px;
    max-width: 500px;
    width: 90%;
    max-height: 80vh;
    overflow-y: auto;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
  }

  .cookie-modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1.5rem;
    border-bottom: 1px solid #ecf0f1;
  }

  .cookie-modal-header h3 {
    margin: 0;
    color: #2c3e50;
  }

  .cookie-modal-close {
    background: none;
    border: none;
    font-size: 1.5rem;
    cursor: pointer;
    color: #7f8c8d;
    padding: 0;
    width: 30px;
    height: 30px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .cookie-modal-close:hover {
    color: #2c3e50;
  }

  .cookie-modal-body {
    padding: 1.5rem;
  }

  .cookie-category {
    margin-bottom: 1.5rem;
    padding-bottom: 1rem;
    border-bottom: 1px solid #ecf0f1;
  }

  .cookie-category:last-child {
    border-bottom: none;
    margin-bottom: 0;
  }

  .cookie-category-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.5rem;
  }

  .cookie-category-header h4 {
    margin: 0;
    color: #2c3e50;
    font-size: 1rem;
  }

  .cookie-category p {
    margin: 0;
    font-size: 0.9rem;
    color: #7f8c8d;
    line-height: 1.4;
  }

  /* Toggle Switch */
  .cookie-toggle {
    position: relative;
    display: inline-block;
    width: 50px;
    height: 24px;
  }

  .cookie-toggle input {
    opacity: 0;
    width: 0;
    height: 0;
  }

  .cookie-slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: #ccc;
    transition: 0.4s;
    border-radius: 24px;
  }

  .cookie-slider:before {
    position: absolute;
    content: '';
    height: 18px;
    width: 18px;
    left: 3px;
    bottom: 3px;
    background-color: white;
    transition: 0.4s;
    border-radius: 50%;
  }

  input:checked + .cookie-slider {
    background-color: #3498db;
  }

  input:checked + .cookie-slider:before {
    transform: translateX(26px);
  }

  input:disabled + .cookie-slider {
    background-color: #1e8449; /* WCAG AA compliant green */
    cursor: not-allowed;
  }

  .cookie-modal-footer {
    padding: 1.5rem;
    border-top: 1px solid #ecf0f1;
    display: flex;
    gap: 0.5rem;
    justify-content: flex-end;
  }

  /* Responsive Design */
  @media (max-width: 768px) {
    .cookie-consent-content {
      flex-direction: column;
      align-items: stretch;
    }

    .cookie-consent-buttons {
      justify-content: center;
    }

    .cookie-btn {
      flex: 1;
      min-width: 0;
    }

    .cookie-modal-content {
      width: 95%;
      margin: 1rem;
    }

    .cookie-modal-footer {
      flex-direction: column;
    }

    .cookie-modal-footer .cookie-btn {
      width: 100%;
    }
  }

  @media (max-width: 480px) {
    .cookie-consent-buttons {
      flex-direction: column;
    }

    .cookie-category-header {
      flex-direction: column;
      align-items: flex-start;
      gap: 0.5rem;
    }
  }
</style>


    <!-- Mermaid support: convert fenced code blocks (```mermaid) and initialize -->
    
    <script src="https://cdn.jsdelivr.net/npm/mermaid@11.9.0/dist/mermaid.min.js" defer></script>
    
    <script>
      (function() {
        'use strict';

        // Use requestIdleCallback for better INP performance
        function scheduleWork(callback) {
          if (window.requestIdleCallback) {
            requestIdleCallback(callback, { timeout: 2000 });
          } else {
            setTimeout(callback, 0);
          }
        }

        function convertMermaidCodeFences() {
          try {
            // Use more efficient selector and batch DOM operations
            const codeBlocks = document.querySelectorAll('pre > code.language-mermaid, pre > code.mermaid');
            const fragment = document.createDocumentFragment();
            const replacements = [];

            codeBlocks.forEach(function(code) {
              const pre = code.parentElement;
              const container = pre.parentElement;
              const div = document.createElement('div');
              div.className = 'mermaid';
              div.textContent = code.textContent;
              replacements.push({ container, pre, div });
            });

            // Batch DOM updates to minimize layout thrashing
            replacements.forEach(({ container, pre, div }) => {
              container.replaceChild(div, pre);
            });
          } catch (e) {
            console.warn('Mermaid code fence conversion failed:', e);
          }
        }

        function initMermaidNow() {
          try {
            if (!window.mermaid) return false;

            scheduleWork(() => {
              convertMermaidCodeFences();
              if (typeof mermaid.initialize === 'function') {
                mermaid.initialize({
                  startOnLoad: false, // Better control over timing
                  theme: 'default'
                });
              }

              scheduleWork(() => {
                if (typeof mermaid.run === 'function') {
                  mermaid.run({ querySelector: '.mermaid' });
                } else if (typeof mermaid.init === 'function') {
                  mermaid.init(undefined, document.querySelectorAll('.mermaid'));
                }
              });
            });

            return true;
          } catch (e) {
            console.error('Mermaid initialization error:', e);
            return false;
          }
        }

        // Use passive event listeners for better performance
        function whenReady(fn) {
          if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', fn, { passive: true });
          } else {
            scheduleWork(fn);
          }
        }

        // Improved initialization with timeout and better error handling
        whenReady(function() {
          scheduleWork(() => {
            if (initMermaidNow()) return;

            let attempts = 0;
            const maxAttempts = 30; // Reduced from 50
            const checkInterval = 200; // Increased from 100ms

            const timer = setInterval(function() {
              attempts++;
              if (initMermaidNow() || attempts >= maxAttempts) {
                clearInterval(timer);
                if (attempts >= maxAttempts) {
                  console.warn('Mermaid initialization timed out after', maxAttempts, 'attempts');
                }
              }
            }, checkInterval);
          });
        });
      })();
    </script><script src="/assets/js/print-helper-optimized.js?v=20250909000248" defer></script><script src="/assets/js/accessibility-enhancements.js?v=20250909000248" defer></script>
    <script>
      function hideCookieConsentBanner() {
        const banner = document.getElementById('cookie-consent-banner');
        if (!banner) return;

        // Check if focus is inside the banner
        if (banner.contains(document.activeElement)) {
          // Move focus to body or another visible, focusable element
          if (document.body) {
            document.body.focus();
          }
        }

        // Use inert instead of aria-hidden
        banner.setAttribute('inert', '');
        // Optionally, hide visually as well
        banner.style.display = 'none';
      }

      // Example event handler for accept button
      const acceptBtn = document.getElementById('accept-cookies');
      if (acceptBtn) {
        acceptBtn.addEventListener('click', hideCookieConsentBanner);
      }
    </script>
  </body>
</html>
